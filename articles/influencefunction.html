<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Art of Influence • lava</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The Art of Influence">
<meta property="og:description" content="lava">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lava</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/correlation.html">Estimating partial correlations with lava</a>
    </li>
    <li>
      <a href="../articles/influencefunction.html">The Art of Influence</a>
    </li>
    <li>
      <a href="../articles/nonlinear.html">Non-linear latent variable models and error-in-variable models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kkholst/lava/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="influencefunction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The Art of Influence</h1>
            <h3 data-toc-skip class="subtitle">A Practical Guide to Working with Influence Functions</h3>
                        <h4 data-toc-skip class="author">Klaus Kähler Holst</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kkholst/lava/blob/HEAD/vignettes/influencefunction.Rmd" class="external-link"><code>vignettes/influencefunction.Rmd</code></a></small>
      <div class="hidden name"><code>influencefunction.Rmd</code></div>

    </div>

    
    
<!-- \newcommand{\Dto}{\rightsquigarrow} -->
<div class="section level2">
<h2 id="influence-functions">Influence functions<a class="anchor" aria-label="anchor" href="#influence-functions"></a>
</h2>
<p>Estimators that have parametric convergence rates can often be fully characterized by their <em>influence function</em> (IF), also referred to as an influence curve or canonical gradient <span class="citation">(Bickel et al. 1998; Vaart 1998)</span>. The IF allows for the direct estimation of properties of the estimator, including its asymptotic variance. Moreover, estimates of the IF enable the simple combination and transformation of estimators into new ones. This vignette describes how to estimate and manipulate IFs using the R-package <code>lava</code> <span class="citation">(Holst and Budtz-Jørgensen 2013)</span>.</p>
<p>Formally, let <span class="math inline">\(Z_1,\ldots,Z_n\)</span> be iid <span class="math inline">\(k\)</span>-dimensional stochastic variables, <span class="math inline">\(Z_i=(Y_{i},A_{i},W_{i})\sim P_{0}\)</span>, and <span class="math inline">\(\widehat{\theta}\)</span> a consistent estimator for the parameter <span class="math inline">\(\theta\in\mathbb{R}^p\)</span>. When <span class="math inline">\(\widehat{\theta}\)</span> is a <em>regular and asymptotic linear</em> (RAL) estimator, it has a unique iid decomposition <span class="math display">\[\begin{align*} \sqrt{n}(\widehat{\theta}-\theta) =
\frac{1}{\sqrt{n}}\sum_{i=1}^n \operatorname{IC}(Z_i; P_{0}) + o_{P}(1), 
\end{align*}\]</span> where the function <span class="math inline">\(\operatorname{IC}\)</span> is the unique <em>Influence Function</em> s.t. <span class="math inline">\(\mathbb{E}\{\operatorname{IC}(Z_{i}; P_{0})\}=0\)</span> and <span class="math inline">\(\mathbb{V}\!\text{ar}\{\operatorname{IC}(Z_{i}; P_{0})^{2}\}&lt;\infty\)</span> <span class="citation">(Tsiatis 2006; Vaart 1998)</span>. The influence function thus fully characterizes the asymptotic behaviour of the estimator and by the central limit theorem it follows that the estimator converges weakly to a Gaussian distribution <span class="math display">\[
\sqrt{n}(\widehat{\theta}-\theta) \overset{\mathcal{D}}{\longrightarrow}
\mathcal{N}(0, \mathbb{V}\!\text{ar}\{\operatorname{IC}(Z; P_{0})\}),
\]</span> where the empirical variance of the plugin estimator, <span class="math inline">\(\mathbb{P}_{n}\operatorname{IC}(Z; \widehat{P})^{\otimes 2} = \frac{1}{n}\sum_{i=1}^n \operatorname{IC}(Z_{i}; \widehat{P})\operatorname{IC}(Z_{i}; \widehat{P})^{\top}\)</span> can be used to obtain a consistent estimate of the asymptotic variance. Note, in practice the estimate <span class="math inline">\(\widehat{P}\)</span> used in the plugin-estimate, needs only to capture the parts of the distribution of <span class="math inline">\(Z\)</span> that is necessary to evaluate the IF. In some cases this nuisance parameter can be estimated using flexible machine learning components and in other (parametric) cases be derived directly from <span class="math inline">\(\widehat{\theta}\)</span>.</p>
<p>The IFs are easily derived for the parameters of many parametric statistical models as illustrated in the <a href="#example-generalized-linear-model">next example sections</a>. More generally, the IF can also be derived for a smooth target parameter <span class="math inline">\(\Psi: \mathcal{P}\to\mathbb{R}\)</span> where <span class="math inline">\(\mathcal{P}\)</span> is a family of probability distributions forming the statistical model, which often can be left completely non-parametric. Formally, the parameter must be <em>pathwise differentiable</em> see <span class="citation">(Vaart 1998)</span> in the sense that there exists linear bounded function <span class="math inline">\(\dot\Psi\colon L_{2}(P_{0})\to\mathbb{R}\)</span> such that <span class="math inline">\([\Psi(P_{t}) - \Psi(P_{0}))]t^{-1} \to \dot\Psi(P_{0})(g)\)</span> as <span class="math inline">\(t\to 0\)</span> for any parametric submodel <span class="math inline">\(P_t\)</span> with score model <span class="math inline">\(g(z)= \partial/(\partial t) \log (p_t)(z)|_{t=0}\)</span>. Riesz’s representation theorem then tells us that the directional derivative has a unique representer, <span class="math inline">\(\phi_{P_{0}}\)</span> lying in the closure of the submodel score space (the <em>tangent space</em>), s.t. <span class="math display">\[\begin{align*}
    \dot\Psi(P_0)(g) = \langle\phi_{P_0}, g\rangle =
    \int \phi_{P_0}(Z)g(X)\,dP_0
\end{align*}\]</span> The unique representer is exactly the IF which can be found by solving the above integral equation. For more details on how to derive influence functions, we refer to <span class="citation">(Laan and Rose 2011; Hines et al. 2022)</span>.</p>
<p>As an example we might be interested in the target parameter <span class="math inline">\(\Psi(P) = \mathbb{E}_P(Z)\)</span> which can be shown to have the unique (and thereby efficient) influence function <span class="math inline">\(Z\mapsto Z-\mathbb{E}_P(Z)\)</span> under the non-parametric model. Another target parameter could be <span class="math inline">\(\Psi_{a}(P) = \mathbb{E}_{P}[\mathbb{E}_{P}(Y\mid A=a, W)]\)</span> which is often a key interest in causal inference and which has the IF <span class="math display">\[\begin{align*}
\operatorname{IC}(Y,A,W; P) = \frac{\mathbf{1}(A=a)}{\mathbb{P}(A=a\mid W)}(Y-\mathbb{E}_{P}[Y\mid A=a,W]) + \mathbb{E}_{P}[Y\mid
A=a,W] - \Psi_{a}(P)
    \end{align*}\]</span> See section on <a href="#average-treatment-effects">average treatment effects</a>.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>To illustrate the methods we consider data arising from the model <span class="math inline">\(Y_{ij} \sim Bernoulli\{\operatorname{expit}(X_{ij} + A_{i} + W_{i})\}, A_{i} \sim Bernoulli\{\operatorname{expit}(W_{i})\}\)</span> with independent covariates <span class="math inline">\(X_{ij}\sim\mathcal{N}(0,1), U_{i}\sim\mathcal{N}(0,1)\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lvm.html">lvm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/regression-set.html">regression</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">a</span> <span class="op">+</span> <span class="va">w</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/regression-set.html">regression</a></span><span class="op">(</span><span class="va">y2</span> <span class="op">~</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">a</span> <span class="op">+</span> <span class="va">w</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/regression-set.html">regression</a></span><span class="op">(</span><span class="va">y3</span> <span class="op">~</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">a</span> <span class="op">+</span> <span class="va">w</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/regression-set.html">regression</a></span><span class="op">(</span><span class="va">y4</span> <span class="op">~</span> <span class="va">x4</span> <span class="op">+</span> <span class="va">a</span> <span class="op">+</span> <span class="va">w</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/regression-set.html">regression</a></span><span class="op">(</span><span class="va">a</span> <span class="op">~</span> <span class="va">w</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/sim.html">distribution</a></span><span class="op">(</span><span class="op">~</span> <span class="va">y1</span> <span class="op">+</span> <span class="va">y2</span> <span class="op">+</span> <span class="va">y3</span> <span class="op">+</span> <span class="va">y4</span> <span class="op">+</span> <span class="va">a</span>, value <span class="op">=</span> <span class="fu"><a href="../reference/sim.html">binomial.lvm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/sim.html">distribution</a></span><span class="op">(</span><span class="op">~</span><span class="va">id</span>, value <span class="op">=</span> <span class="fu"><a href="../reference/sim.html">Sequence.lvm</a></span><span class="op">(</span>integer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We simulate from the model where <span class="math inline">\(Y_3\)</span> is only observed for half of the subjects</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">4e2</span></span>
<span><span class="va">dw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim.html">sim</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">n</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>y3 <span class="op">=</span> <span class="va">y3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">id</span> <span class="op">&gt;</span> <span class="va">n</span> <span class="op">/</span> <span class="fl">2</span>, <span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Print.html">Print</a></span><span class="op">(</span><span class="va">dw</span><span class="op">)</span></span>
<span><span class="co">#&gt;     y1 x1       a w        y2 x2       y3 x3       y4 x4        id </span></span>
<span><span class="co">#&gt; 1   1  -0.6265  1  1.0744  0  -1.08691 1  -1.5570  1   0.34419  1  </span></span>
<span><span class="co">#&gt; 2   1   0.1836  1  1.8957  1  -1.82608 1   1.9232  1   0.01272  2  </span></span>
<span><span class="co">#&gt; 3   0  -0.8356  0 -0.6030  0   0.99528 0  -1.8568  0  -0.87345  3  </span></span>
<span><span class="co">#&gt; 4   0   1.5953  0 -0.3909  1  -0.01186 0  -2.1061  1   0.34280  4  </span></span>
<span><span class="co">#&gt; 5   0   0.3295  1 -0.4162  0  -0.59963 1   0.6976  1  -0.17739  5  </span></span>
<span><span class="co">#&gt; ---                                                                </span></span>
<span><span class="co">#&gt; 396 0  -0.92431 0 -1.02939 0  -0.30825 NA -1.05037 0  -0.008056 396</span></span>
<span><span class="co">#&gt; 397 1   1.59291 1 -0.01093 1   0.01552 NA  1.63787 1   1.033784 397</span></span>
<span><span class="co">#&gt; 398 0   0.04501 0 -1.22499 0  -0.44232 NA -1.20733 0  -0.799127 398</span></span>
<span><span class="co">#&gt; 399 0  -0.71513 0 -2.59611 0  -1.63801 NA -2.62616 0   1.004233 399</span></span>
<span><span class="co">#&gt; 400 1   0.86522 1  1.16912 0  -0.64140 NA  0.01746 1  -0.311973 400</span></span>
<span><span class="co">## Data in long format</span></span>
<span><span class="va">dl</span> <span class="op">&lt;-</span> <span class="fu">mets</span><span class="fu">::</span><span class="fu"><a href="https://kkholst.github.io/mets/reference/fast.reshape.html" class="external-link">fast.reshape</a></span><span class="op">(</span><span class="va">dw</span>, varying <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="st">"x"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Print.html">Print</a></span><span class="op">(</span><span class="va">dl</span><span class="op">)</span></span>
<span><span class="co">#&gt;      a w      id  y x       num</span></span>
<span><span class="co">#&gt; 1    1 1.074  1   1 -0.6265 1  </span></span>
<span><span class="co">#&gt; 2    1 1.074  1   0 -1.0869 2  </span></span>
<span><span class="co">#&gt; 3    1 1.074  1   1 -1.5570 3  </span></span>
<span><span class="co">#&gt; 4    1 1.074  1   1  0.3442 4  </span></span>
<span><span class="co">#&gt; 5    1 1.896  2   1  0.1836 1  </span></span>
<span><span class="co">#&gt; ---                            </span></span>
<span><span class="co">#&gt; 1594 0 -2.596 399 0 -1.6380 2  </span></span>
<span><span class="co">#&gt; 1596 0 -2.596 399 0  1.0042 4  </span></span>
<span><span class="co">#&gt; 1597 1  1.169 400 1  0.8652 1  </span></span>
<span><span class="co">#&gt; 1598 1  1.169 400 0 -0.6414 2  </span></span>
<span><span class="co">#&gt; 1600 1  1.169 400 1 -0.3120 4</span></span></code></pre></div>
<div class="section level3">
<h3 id="example-population-mean">Example: population mean<a class="anchor" aria-label="anchor" href="#example-population-mean"></a>
</h3>
<p>The main functions for working with influence functions are</p>
<ul>
<li>
<code>estimate</code> which prepares a model object and estimates the IF and corresponding robust standard errors. Can also be used to transform model parameters by application of the Delta Theorem.</li>
<li>
<code>merge</code>, <code>+</code> method for combining estimates via their estimated IFs</li>
<li>
<code>IC</code> method to extract the estimated IF</li>
</ul>
<p>The <code>estimate</code> function is the primary tool for obtaining parameter estimates and related information. It returns an object of the class type <code>estimate</code>, which is general container for holding information about estimated parameters. The estimate function takes as input either a model object (the first argument <code>x</code>), or a parameter vector and corresponding influence function (IF) matrix specified using the <code>coef</code> and <code>IF</code> arguments. If the primary goal is to apply the delta method or test linear hypotheses, it is also possible to provide the asymptotic variance estimate via the <code>vcov</code> argument, without specifying the IF matrix.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span>x<span class="op">=</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span>coef<span class="op">=</span>, IF<span class="op">=</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span>coef<span class="op">=</span>, vcov<span class="op">=</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<p>Here we first consider the problem of estimating the IF of the mean. For a general transformation <span class="math inline">\(f: \mathbb{R}^k\to\mathbb{R}^p\)</span> we have that <span class="math display">\[
\sqrt{n}\{\mathbb{P}_{n}f(X) - \mathbb{E}[f(X)]\} = \frac{1}{\sqrt{n}}\sum_{i=1}^{n} 
f(X_{i}) - \mathbb{E}[f(X)]
\]</span> <!-- \[
<!-- \sqrt{n}\{\mathbb{P}_{n}f(X) - \pr(Y_{1}=1)\} = \frac{1}{\sqrt{n}}\sum_{i=1}^{n} --> <!-- \one(Y_{1i}=1) - \pr(Y_{1}=1) --> <!-- \]  --> and hence for the problem of estimating the proportion of the binary outcome <span class="math inline">\(Y_1\)</span>, the IF is given by <span class="math inline">\(\mathbf{1}(Y_{1}=1) - \mathbb{P}(Y_{1}=1)\)</span>.</p>
<p>To estimate this parameter and its IF we will use the <code>estimate</code> function</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">dw</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">inp</span><span class="op">[</span>, <span class="fl">1</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"mean"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "estimate"</span></span>
<span><span class="va">e</span></span>
<span><span class="co">#&gt;    Estimate Std.Err   2.5%  97.5%    P-value</span></span>
<span><span class="co">#&gt; y1     0.61 0.02439 0.5622 0.6578 4.435e-138</span></span></code></pre></div>
<p>The reported standard errors from the <code>estimate</code> method are the robust standard errors obtained from the IF. The variance estimate and the parameters can be extracted with the <code>vcov</code> and <code>coef</code> methods. The IF itself can be extracted with the <code>IC</code> (or <code>influence</code>) method:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/IC.html">IC</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/Print.html">Print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;     y1   </span></span>
<span><span class="co">#&gt; 1    0.39</span></span>
<span><span class="co">#&gt; 2    0.39</span></span>
<span><span class="co">#&gt; 3   -0.61</span></span>
<span><span class="co">#&gt; 4   -0.61</span></span>
<span><span class="co">#&gt; 5   -0.61</span></span>
<span><span class="co">#&gt; ---      </span></span>
<span><span class="co">#&gt; 396 -0.61</span></span>
<span><span class="co">#&gt; 397  0.39</span></span>
<span><span class="co">#&gt; 398 -0.61</span></span>
<span><span class="co">#&gt; 399 -0.61</span></span>
<span><span class="co">#&gt; 400  0.39</span></span></code></pre></div>
<p>It is also possible to simultaneously estimate the proportions of each of the two binary outcomes</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">inp</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Estimate Std.Err   2.5%  97.5%    P-value</span></span>
<span><span class="co">#&gt; y1    0.610 0.02439 0.5622 0.6578 4.435e-138</span></span>
<span><span class="co">#&gt; y2    0.535 0.02494 0.4861 0.5839 4.316e-102</span></span></code></pre></div>
<p>or alternatively the input can be a model object, here a <code>mlm</code> object:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y1</span>, <span class="va">y2</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">dw</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/IC.html">IC</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   y1:(Intercept) y2:(Intercept)</span></span>
<span><span class="co">#&gt; 1           0.39         -0.535</span></span>
<span><span class="co">#&gt; 2           0.39          0.465</span></span>
<span><span class="co">#&gt; 3          -0.61         -0.535</span></span>
<span><span class="co">#&gt; 4          -0.61          0.465</span></span>
<span><span class="co">#&gt; 5          -0.61         -0.535</span></span>
<span><span class="co">#&gt; 6          -0.61          0.465</span></span></code></pre></div>
<p>Different methods are available for inspecting an <code>estimate</code> object</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: estimate.default(x = x, coef = pars(x))</span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt;                Estimate Std.Err   2.5%  97.5%    P-value</span></span>
<span><span class="co">#&gt; y1:(Intercept)    0.610 0.02439 0.5622 0.6578 4.435e-138</span></span>
<span><span class="co">#&gt; y2:(Intercept)    0.535 0.02494 0.4861 0.5839 4.316e-102</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Null Hypothesis: </span></span>
<span><span class="co">#&gt;   [y1:(Intercept)] = 0</span></span>
<span><span class="co">#&gt;   [y2:(Intercept)] = 0 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; chisq = 955.6986, df = 2, p-value &lt; 2.2e-16</span></span>
<span><span class="co">## extract parameter coefficients</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt; y1:(Intercept) y2:(Intercept) </span></span>
<span><span class="co">#&gt;          0.610          0.535</span></span>
<span><span class="co">## ## Asymptotic (robust) variance estimate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt;                y1:(Intercept) y2:(Intercept)</span></span>
<span><span class="co">#&gt; y1:(Intercept)     5.9475e-04   0.0000841250</span></span>
<span><span class="co">#&gt; y2:(Intercept)     8.4125e-05   0.0006219375</span></span>
<span><span class="co">## Matrix with estimates and confidence limits</span></span>
<span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">e</span>, level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/internal.html">parameter</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                Estimate    Std.Err      0.5%     99.5%       P-value</span></span>
<span><span class="co">#&gt; y1:(Intercept)    0.610 0.02438750 0.5471820 0.6728180 4.434692e-138</span></span>
<span><span class="co">#&gt; y2:(Intercept)    0.535 0.02493867 0.4707622 0.5992378 4.316104e-102</span></span>
<span><span class="co">## Influence curve</span></span>
<span><span class="fu"><a href="../reference/IC.html">IC</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   y1:(Intercept) y2:(Intercept)</span></span>
<span><span class="co">#&gt; 1           0.39         -0.535</span></span>
<span><span class="co">#&gt; 2           0.39          0.465</span></span>
<span><span class="co">#&gt; 3          -0.61         -0.535</span></span>
<span><span class="co">#&gt; 4          -0.61          0.465</span></span>
<span><span class="co">#&gt; 5          -0.61         -0.535</span></span>
<span><span class="co">#&gt; 6          -0.61          0.465</span></span>
<span><span class="co">## Join estimates</span></span>
<span><span class="va">e</span> <span class="op">+</span> <span class="va">e</span> <span class="co"># Same as merge(e,e)</span></span>
<span><span class="co">#&gt;                  Estimate Std.Err   2.5%  97.5%    P-value</span></span>
<span><span class="co">#&gt; y1:(Intercept)      0.610 0.02439 0.5622 0.6578 4.435e-138</span></span>
<span><span class="co">#&gt; y2:(Intercept)      0.535 0.02494 0.4861 0.5839 4.316e-102</span></span>
<span><span class="co">#&gt; ────────────────                                          </span></span>
<span><span class="co">#&gt; y1:(Intercept).1    0.610 0.02439 0.5622 0.6578 4.435e-138</span></span>
<span><span class="co">#&gt; y2:(Intercept).1    0.535 0.02494 0.4861 0.5839 4.316e-102</span></span></code></pre></div>
<!-- The IF for both the empirical mean and variance can also be estimated directly with the `IC` method: -->
<!-- ```{r} -->
<!-- with(dw, IC(y1)) |> head() -->
<!-- ## point estimates stores in the attributes -->
<!-- with(dw, IC(y1)) |> attributes() -->
<!-- ``` -->
</div>
<div class="section level3">
<h3 id="example-generalized-linear-model">Example: generalized linear model<a class="anchor" aria-label="anchor" href="#example-generalized-linear-model"></a>
</h3>
<p>For a <span class="math inline">\(Z\)</span>-estimator defined by the score equation <span class="math inline">\(E[U(Z; \theta)] = 0\)</span>, the IF is given by <span class="math display">\[\begin{align*} IC(Z; \theta) =
\mathbb{E}\Big\{\frac{\partial}{\partial\theta^\top}U(\theta; Z)\Big\}^{-1}U(Z; \theta)
\end{align*}\]</span> In particular, for a maximum likelihood estimator the score, <span class="math inline">\(U\)</span>, is given by the partial derivative of the log-likelihood function.</p>
<p>As an example, we can obtain the estimates with robust standard errors for a logistic regression model:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">a</span> <span class="op">+</span> <span class="va">x1</span>, data <span class="op">=</span> <span class="va">dw</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Estimate Std.Err    2.5%   97.5%   P-value</span></span>
<span><span class="co">#&gt; (Intercept)  -0.2687  0.1622 -0.5867 0.04931 9.772e-02</span></span>
<span><span class="co">#&gt; a             1.5595  0.2428  1.0835 2.03545 1.348e-10</span></span>
<span><span class="co">#&gt; x1            0.9728  0.1435  0.6916 1.25397 1.198e-11</span></span></code></pre></div>
<p>We can compare that to the usual (non-robust) standard errors:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g</span>, robust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Estimate Std.Err    2.5%   97.5%   P-value</span></span>
<span><span class="co">#&gt; (Intercept)  -0.2687  0.1589 -0.5802 0.04281 9.091e-02</span></span>
<span><span class="co">#&gt; a             1.5595  0.2423  1.0846 2.03433 1.220e-10</span></span>
<span><span class="co">#&gt; x1            0.9728  0.1396  0.6992 1.24634 3.177e-12</span></span></code></pre></div>
<p>The IF can be extracted from the <code>estimate</code> object or directly from the model object</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/IC.html">IC</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   (Intercept)          a         x1</span></span>
<span><span class="co">#&gt; 1  0.09816353   3.715892 -0.8478763</span></span>
<span><span class="co">#&gt; 2 -0.08203584   2.562573  0.7085752</span></span>
<span><span class="co">#&gt; 3 -2.74896196   3.316937  1.8772112</span></span>
<span><span class="co">#&gt; 4 -6.78328520   4.052090 -9.0268560</span></span>
<span><span class="co">#&gt; 5  0.47533946 -11.818085 -4.1056905</span></span>
<span><span class="co">#&gt; 6 -2.77584564   3.340948  1.8677174</span></span></code></pre></div>
<p>The same estimates can be obtained with a <em>cumulative link regression</em> model which also generalizes to ordinal outcomes. Here we consider the proportional odds model given by <span class="math display">\[\begin{align*}
\log\left(\frac{\mathbb{P}(Y\leq j\mid x)}{1-\mathbb{P}(Y\leq j\mid x)}\right) = \alpha_{j} + \beta^{t}x, \quad j=1,\ldots,J
\end{align*}\]</span></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ordreg.html">ordreg</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">a</span> <span class="op">+</span> <span class="va">x1</span>, <span class="va">dw</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Estimate Std.Err     2.5%  97.5%   P-value</span></span>
<span><span class="co">#&gt; 0|1   0.2687  0.1622 -0.04932 0.5867 9.772e-02</span></span>
<span><span class="co">#&gt; a     1.5595  0.2429  1.08349 2.0355 1.350e-10</span></span>
<span><span class="co">#&gt; x1    0.9728  0.1435  0.69157 1.2540 1.200e-11</span></span></code></pre></div>
<p>Note that the <code><a href="https://sandwich.R-Forge.R-project.org/reference/estfun.html" class="external-link">sandwich::estfun</a></code> function from the <code>sandwich</code> library <span class="citation">(Zeileis, Köll, and Graham 2020)</span> can also estimate the IF for different parametric models, but does not provide the tools for combining and transforming these.</p>
</div>
<div class="section level3">
<h3 id="example-right-censored-outcomess">Example: right-censored outcomess<a class="anchor" aria-label="anchor" href="#example-right-censored-outcomess"></a>
</h3>
<p>To illustrate the methods on survival data we will use the Mayo Clinic Primary Biliary Cholangitis Data <span class="citation">(Therneau and Grambsch 2000)</span></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/therneau/survival" class="external-link">"survival"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pbc</span>, package<span class="op">=</span><span class="st">"survival"</span><span class="op">)</span></span></code></pre></div>
<p>The Cox proportional hazards model can be fitted with the <code><a href="https://kkholst.github.io/mets/reference/phreg.html" class="external-link">mets::phreg</a></code> method which can estimate the IF for both the partial likelihood parameters and the baseline hazard. Here we fit a survival model with right-censored event times</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.phreg</span> <span class="op">&lt;-</span> <span class="fu">mets</span><span class="fu">::</span><span class="fu"><a href="https://kkholst.github.io/mets/reference/phreg.html" class="external-link">phreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">pbc</span><span class="op">)</span></span>
<span><span class="va">fit.phreg</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; mets::phreg(formula = Surv(time, status &gt; 0) ~ age + sex, data = pbc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    n events</span></span>
<span><span class="co">#&gt;  418    186</span></span>
<span><span class="co">#&gt; coeffients:</span></span>
<span><span class="co">#&gt;        Estimate       S.E.    dU^-1/2 P-value</span></span>
<span><span class="co">#&gt; age   0.0220977  0.0070372  0.0072712  0.0017</span></span>
<span><span class="co">#&gt; sexf -0.2999507  0.2022144  0.2097533  0.1380</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; exp(coeffients):</span></span>
<span><span class="co">#&gt;      Estimate    2.5%  97.5%</span></span>
<span><span class="co">#&gt; age   1.02234 1.00834 1.0365</span></span>
<span><span class="co">#&gt; sexf  0.74085 0.49843 1.1012</span></span>
<span><span class="fu"><a href="../reference/IC.html">IC</a></span><span class="op">(</span><span class="va">fit.phreg</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;           age       sexf</span></span>
<span><span class="co">#&gt; 1  0.12691175  2.9551968</span></span>
<span><span class="co">#&gt; 2 -0.16011629 -4.3755455</span></span>
<span><span class="co">#&gt; 3  0.19322595 -8.1786480</span></span>
<span><span class="co">#&gt; 4  0.04668109  0.8548021</span></span>
<span><span class="co">#&gt; 5 -0.22936186  0.9721761</span></span>
<span><span class="co">#&gt; 6  0.07015171  0.5644414</span></span></code></pre></div>
<p>The IF for the baseline cumulative hazard at a specific time point <span class="math display">\[\begin{align*}
\Lambda_0(t) = \int_0^t \lambda_0(u)\,du, 
\end{align*}\]</span> where <span class="math inline">\(\lambda_0(t)\)</span> is the baseline hazard, can be estimated in similar way:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseline</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">time</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ic</span> <span class="op">&lt;-</span> <span class="fu">mets</span><span class="fu">::</span><span class="fu"><a href="https://kkholst.github.io/lava/reference/IC.html" class="external-link">IC</a></span><span class="op">(</span><span class="va">object</span>, baseline <span class="op">=</span> <span class="cn">TRUE</span>, time <span class="op">=</span> <span class="va">time</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">mets</span><span class="fu">::</span><span class="fu"><a href="https://kkholst.github.io/mets/reference/fast.approx.html" class="external-link">predictCumhaz</a></span><span class="op">(</span><span class="va">object</span><span class="op">$</span><span class="va">cumhaz</span>, new.time <span class="op">=</span> <span class="va">time</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="cn">NULL</span>, coef <span class="op">=</span> <span class="va">est</span>, IC <span class="op">=</span> <span class="va">ic</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chaz:"</span>, <span class="va">time</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">tt</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span>
<span><span class="fu">baseline</span><span class="op">(</span><span class="va">fit.phreg</span>, <span class="va">tt</span><span class="op">)</span></span>
<span><span class="co">#&gt;           Estimate Std.Err    2.5%  97.5% P-value</span></span>
<span><span class="co">#&gt; chaz:2000    0.178 0.07597 0.02913 0.3269 0.01911</span></span></code></pre></div>
<p>The <code>estimate</code> and <code>IF</code> methods are also available for parametric survival models via <code><a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survival::survreg</a></code>, here a Weibull model:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">pbc</span>, dist<span class="op">=</span><span class="st">"weibull"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Estimate  Std.Err     2.5%     97.5%    P-value</span></span>
<span><span class="co">#&gt; (Intercept)  9.02697 0.382437  8.27741  9.776530 3.521e-123</span></span>
<span><span class="co">#&gt; age         -0.01919 0.006362 -0.03166 -0.006723  2.554e-03</span></span>
<span><span class="co">#&gt; sexf         0.28170 0.174338 -0.06000  0.623392  1.061e-01</span></span>
<span><span class="co">#&gt; scale        0.87751 0.070693  0.73896  1.016067  2.220e-35</span></span></code></pre></div>
<!-- glm poisson -->
<!-- ```{r lifetable} -->
<!-- pbc2 <- mets::lifetable(Surv(time, status > 0) ~ sex, data = pbc, breaks = seq(0, 5000, length.out = 10)) -->
<!-- head(pbc2) -->
<!-- glm(events ~ offset(log(atrisk)) + sex + factor(int.end), data = pbc2, family=poisson(log)) -->
<!-- ``` -->
</div>
<div class="section level3">
<h3 id="example-random-effects-model-structural-equation-model">Example: random effects model / structural equation model<a class="anchor" aria-label="anchor" href="#example-random-effects-model-structural-equation-model"></a>
</h3>
<p>General structural equation models (SEMs) can be estimated with <code><a href="../reference/lvm.html">lava::lvm</a></code>. Here we fit a random effects probit model <span class="math display">\[
\mathbb{P}(Y_{ij} = 1 \mid U_{i}, W_{ij})=\Phi(\mu_{j} + \beta_{j} W_{ij} + U_{i}), \quad U_{i}\sim\mathcal{N}(0,\sigma_{u}^{2}),\quad j=1,2
\]</span> to the simulated dataset</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lvm.html">lvm</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">+</span> <span class="va">y2</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">*</span> <span class="va">u</span> <span class="op">+</span> <span class="va">w</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/vars.html">latent</a></span><span class="op">(</span><span class="op">~</span> <span class="va">u</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ordinal-set.html">ordinal</a></span><span class="op">(</span>K<span class="op">=</span><span class="fl">2</span>, <span class="op">~</span> <span class="va">y1</span> <span class="op">+</span> <span class="va">y2</span><span class="op">)</span></span>
<span><span class="va">semfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">sem</span>, data <span class="op">=</span> <span class="va">dw</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Robust standard errors</span></span>
<span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">semfit</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Estimate Std.Err    2.5%    97.5%   P-value</span></span>
<span><span class="co">#&gt; y2   -0.21037 0.09391 -0.3944 -0.02630 2.509e-02</span></span>
<span><span class="co">#&gt; u     0.36025 0.06659  0.2297  0.49076 6.295e-08</span></span>
<span><span class="co">#&gt; y1~w  0.55425 0.06931  0.4184  0.69009 1.272e-15</span></span>
<span><span class="co">#&gt; y2~w  0.59388 0.07510  0.4467  0.74108 2.624e-15</span></span>
<span><span class="co">#&gt; u~~u -0.09496 0.07360 -0.2392  0.04929 1.970e-01</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-quantile">Example: quantile<a class="anchor" aria-label="anchor" href="#example-quantile"></a>
</h3>
<p>Let <span class="math inline">\(\beta\)</span> denote the <span class="math inline">\(\tau\)</span>th quantile of <span class="math inline">\(X\)</span>, with IF <span class="math display">\[\begin{align*}
\operatorname{IC}(x; P_{0}) = \tau - \mathbf{1}(x\leq \beta)f_{0}(\beta)^{-1} 
\end{align*}\]</span></p>
<p>where <span class="math inline">\(f_{0}\)</span> is the density function of <span class="math inline">\(X\)</span>.</p>
<p>To calculate the variance estimate, an estimate of the density is thus needed which can be obtained by a kernel estimate. Alternatively, the resampling method of <span class="citation">(Zeng and Lin 2008)</span> can be applied. Here we use a kernel smoother (additional arguments to the <code>estimate</code> function are parsed on to <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">stats::density.default</a></code>) to estimate the quantiles and IF for the 25%, 50%, and 75% quantiles of <span class="math inline">\(W\)</span> and <span class="math inline">\(X_1\)</span></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">dw</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w"</span>, <span class="st">"x1"</span><span class="op">)</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"quantile"</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">eq</span></span>
<span><span class="co">#&gt;        Estimate Std.Err    2.5%    97.5%   P-value</span></span>
<span><span class="co">#&gt; w.25%  -0.81214 0.07270 -0.9546 -0.66965 5.649e-29</span></span>
<span><span class="co">#&gt; w.50%  -0.11062 0.07195 -0.2516  0.03040 1.242e-01</span></span>
<span><span class="co">#&gt; w.75%   0.67716 0.07778  0.5247  0.82960 3.133e-18</span></span>
<span><span class="co">#&gt; x1.25% -0.57510 0.06334 -0.6992 -0.45096 1.090e-19</span></span>
<span><span class="co">#&gt; x1.50% -0.02664 0.06073 -0.1457  0.09238 6.609e-01</span></span>
<span><span class="co">#&gt; x1.75%  0.69590 0.06690  0.5648  0.82703 2.437e-25</span></span>
<span><span class="fu"><a href="../reference/IC.html">IC</a></span><span class="op">(</span><span class="va">eq</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;          w.25%     w.50%      w.75%     x1.25%    x1.50%     x1.75%</span></span>
<span><span class="co">#&gt; [1,] 0.8394734  1.438982  2.6942304 -2.1941660 -1.214564 -0.7725337</span></span>
<span><span class="co">#&gt; [2,] 0.8394734  1.438982  2.6942304  0.7313887  1.214564 -0.7725337</span></span>
<span><span class="co">#&gt; [3,] 0.8394734 -1.438982 -0.8980768 -2.1941660 -1.214564 -0.7725337</span></span>
<span><span class="co">#&gt; [4,] 0.8394734 -1.438982 -0.8980768  0.7313887  1.214564  2.3176012</span></span>
<span><span class="co">#&gt; [5,] 0.8394734 -1.438982 -0.8980768  0.7313887  1.214564 -0.7725337</span></span>
<span><span class="co">#&gt; [6,] 0.8394734 -1.438982 -0.8980768 -2.1941660 -1.214564 -0.7725337</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="combining-influence-functions">Combining influence functions<a class="anchor" aria-label="anchor" href="#combining-influence-functions"></a>
</h2>
<p>A key benefit of working with the IFs of estimators is that this allows for transforming or combining different estimates while easily deriving the resulting IF and thereby asymptotic distribution of the new estimator.</p>
<p>Let <span class="math inline">\(\widehat{\theta}_{1}, \ldots, \widehat{\theta}_{M}\)</span> be <span class="math inline">\(M\)</span> different estimators with decompositions <span class="math display">\[\begin{align*}
\sqrt{n}(\widehat{\theta}_{m}-\theta_{m}) = \frac{1}{\sqrt{n}}\sum_{i=1}^{n}
\operatorname{IC}_m(Z_i; P_{0}) + o_{P}(1)
\end{align*}\]</span> based on iid data <span class="math inline">\(Z_1,\ldots,Z_n\)</span>. It then follows immediately <span class="citation">(Vaart 1998 Theorem 18.10[vi])</span> that the joint distribution of <span class="math inline">\(\widehat{\theta} - {\theta}= (\widehat{\theta}_{1}^{\top},\ldots,\widehat{\theta}_{M}^{\top})^\top- ({\theta}_{1}^{\top},\ldots,{\theta}_{M}^{\top})^\top\)</span> is given by <span class="math display">\[\begin{align*}
\sqrt{n}(\widehat{\theta}-\theta) &amp;= \frac{1}{\sqrt{n}}\sum_{i=1}^{n}
\underbrace{[\operatorname{IC}_{1}(Z_i; P_{0})^\top,\ldots,\operatorname{IC}_{M}(Z_i; P_{0})^\top]^{\top}}_{\overline{\operatorname{IC}}(Z_i; P_{0})} + o_{P}(1) \\
&amp;\overset{\mathcal{D}}{\longrightarrow}\mathcal{N}(0,\Sigma)
\end{align*}\]</span> by the CLT, and under regulatory conditions <span class="math inline">\(\mathbb{P}_{n}\overline{\operatorname{IC}}(Z_i; \widehat{P})^{\otimes 2} \overset{P}{\longrightarrow}\Sigma\)</span> as <span class="math inline">\(n\to\infty\)</span>.</p>
<p>To illustrate this we consider two marginal logistic regression models fitted separately for <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span> and combine the estimates and IFs using the <code>merge</code> method</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">a</span>, family<span class="op">=</span><span class="va">binomial</span>, data<span class="op">=</span><span class="va">dw</span><span class="op">)</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y2</span> <span class="op">~</span> <span class="va">a</span>, family<span class="op">=</span><span class="va">binomial</span>, data<span class="op">=</span><span class="va">dw</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">merge</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: estimate.default(x = NULL, data = NULL, id = id, stack = FALSE, </span></span>
<span><span class="co">#&gt;     IC = ic0, keep = keep, coef = coefs)</span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt;               Estimate Std.Err    2.5%    97.5%   P-value</span></span>
<span><span class="co">#&gt; (Intercept)    -0.1861  0.1442 -0.4688  0.09655 1.969e-01</span></span>
<span><span class="co">#&gt; a               1.3239  0.2173  0.8981  1.74978 1.105e-09</span></span>
<span><span class="co">#&gt; ─────────────                                            </span></span>
<span><span class="co">#&gt; (Intercept).1  -0.6168  0.1505 -0.9117 -0.32185 4.152e-05</span></span>
<span><span class="co">#&gt; a.1             1.5060  0.2148  1.0849  1.92712 2.385e-12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Null Hypothesis: </span></span>
<span><span class="co">#&gt;   [(Intercept)] = 0</span></span>
<span><span class="co">#&gt;   [a] = 0</span></span>
<span><span class="co">#&gt;   [(Intercept).1] = 0</span></span>
<span><span class="co">#&gt;   [a.1] = 0 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; chisq = 96.4362, df = 4, p-value &lt; 2.2e-16</span></span></code></pre></div>
<p>As we have access to the joint asymptotic distribution we can for example test for whether the odds-ratio is the same for the two responses:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">e</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>, null<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Estimate Std.Err    2.5%  97.5% P-value</span></span>
<span><span class="co">#&gt; [a] - [a.1]  -0.1821  0.3003 -0.7707 0.4065  0.5443</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Null Hypothesis: </span></span>
<span><span class="co">#&gt;   [a] - [a.1] = 0</span></span></code></pre></div>
<p>More details an be found in the Section on <a href="#linear-contrasts-and-hypothesis-testing">hypothesis testing</a>.</p>
<div class="section level3">
<h3 id="imbalanced-data">Imbalanced data<a class="anchor" aria-label="anchor" href="#imbalanced-data"></a>
</h3>
<p>Let <span class="math inline">\(O_{1} = (Z_{1}R_{1}, R_{1}), \ldots, O_{N}=(Z_{N}R_{N}, R_{N})\)</span> be iid with <span class="math inline">\(R_{i}\!\perp\!\!\!\!\perp\!Z_i\)</span> and let the full-data IF for some estimator of a parameter <span class="math inline">\(\theta\in\mathbb{R}^p\)</span> be <span class="math inline">\(IC(\cdot; P_{0})\)</span>. For convenience let the data be ordered <span class="math inline">\(R_{i}=\mathbf{1}(i\leq n)\)</span> where <span class="math inline">\(n\)</span> is the number of observed data points, then the complete-case estimator is consistent and based on same IF <span class="math display">\[\begin{align*}
\sqrt{n}(\widehat{\theta}-\theta) = \frac{1}{\sqrt{n}}\sum_{i=1}^n IC(Z_i; P_{0}) + o_{P}(1).
\end{align*}\]</span> This estimator can also be decomposed in terms of the observed data <span class="math inline">\(O_1,\ldots,O_N\)</span> noting that <span class="math display">\[\begin{align*}
\sqrt{N}(\widehat{\theta}-\theta) = \frac{1}{\sqrt{N}}\sum_{i=1}^N IC(Z_i;
P)\frac{R_i N}{n} + o_{P}(1).
\end{align*}\]</span> where the term <span class="math inline">\(\frac{R_i N}{n}\)</span> corresponds to an inverse probability weighting with the empirical plugin estimate of the proportion of observed data <span class="math inline">\(R=1\)</span>. Under a missing completely at random assumption we can therefore combine estimators that are estimated on different datasets. Let the observed data be <span class="math inline">\((Z_{11}R_{11}, R_{11}, Z_{21}R_{21}, R_{21}), \ldots, (Z_{1N}R_{1N}, R_{1N}, Z_{2N}R_{2N}, R_{2N}))\)</span> with complete-case estimators <span class="math inline">\(\widehat{\theta}_1\)</span> and <span class="math inline">\(\widehat{\theta}_2\)</span> for parameters <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span> based on <span class="math inline">\((Z_{11}R_{11}, \ldots, Z_{1N}R_{1N})\)</span> and <span class="math inline">\((Z_{21}R_{21}, \ldots, Z_{2N}R_{2N})\)</span>, respectively, and let the corresponding IFs be <span class="math inline">\(IC_{1}(\cdot; P_{0})\)</span> and <span class="math inline">\(IC_{2}(\cdot;\ P)\)</span>. It then follows that <span class="math display">\[\begin{align*}
\sqrt{N}\left\{
\begin{pmatrix}
\widehat{\theta}_1 \\
\widehat{\theta}_2 
\end{pmatrix}
- 
\begin{pmatrix}
\vphantom{\widehat{\theta}_1}\theta_1 \\
\vphantom{\widehat{\theta}_1}\theta_2 
\end{pmatrix}
\right\}
= 
\frac{1}{\sqrt{N}}\sum_{i=1}^N 
\begin{pmatrix}
IC_1(Z_{1i}; P_{0})\frac{R_{1i}N}{R_{1\bullet}} \\
IC_2(Z_{2i}; P_{0})\frac{R_{2i}N}{R_{2\bullet}}
\end{pmatrix} 
+ o_{P}(1)
\end{align*}\]</span> with <span class="math inline">\(R_{k\bullet} = \sum_{i=1}^{N}R_{ki}.\)</span> Returning to the example, we can combine the marginal estimates of two model objects that have been estimated from different datasets (as the outcome <span class="math inline">\(Y_3\)</span> is only available in half of the data). Here we will use the overloaded <code>+</code> operator</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y2</span> <span class="op">~</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="va">binomial</span>, data <span class="op">=</span> <span class="va">dw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = y2 ~ 1, family = binomial, data = dw)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)   0.1402     0.1002   1.399    0.162</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 552.56  on 399  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 552.56  on 399  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 554.56</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 3</span></span>
<span><span class="va">dwc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">dw</span><span class="op">)</span> </span>
<span><span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y3</span> <span class="op">~</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="va">binomial</span>, data <span class="op">=</span> <span class="va">dwc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = y3 ~ 1, family = binomial, data = dwc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)  </span></span>
<span><span class="co">#&gt; (Intercept)   0.2615     0.1426   1.833   0.0668 .</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 273.87  on 199  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 273.87  on 199  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 275.87</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 3</span></span>
<span></span>
<span><span class="va">e2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g2</span>, id <span class="op">=</span> <span class="va">dw</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="va">e3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g3</span>, id <span class="op">=</span> <span class="st">"id"</span>, data<span class="op">=</span><span class="va">dwc</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/internal.html">merge</a></span><span class="op">(</span><span class="va">e2</span>,<span class="va">e3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/IC.html">IC</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/Print.html">Print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;     (Intercept) (Intercept).1</span></span>
<span><span class="co">#&gt; 1   -2.151       3.540       </span></span>
<span><span class="co">#&gt; 2    1.869       3.540       </span></span>
<span><span class="co">#&gt; 3   -2.151      -4.598       </span></span>
<span><span class="co">#&gt; 4    1.869      -4.598       </span></span>
<span><span class="co">#&gt; 5   -2.151       3.540       </span></span>
<span><span class="co">#&gt; ---                          </span></span>
<span><span class="co">#&gt; 396 -2.151       0.000       </span></span>
<span><span class="co">#&gt; 397  1.869       0.000       </span></span>
<span><span class="co">#&gt; 398 -2.151       0.000       </span></span>
<span><span class="co">#&gt; 399 -2.151       0.000       </span></span>
<span><span class="co">#&gt; 400 -2.151       0.000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">e2</span> <span class="op">+</span> <span class="va">e3</span><span class="op">)</span></span>
<span><span class="co">#&gt;               (Intercept) (Intercept).1</span></span>
<span><span class="co">#&gt; (Intercept)   0.010049191   0.002102598</span></span>
<span><span class="co">#&gt; (Intercept).1 0.002102598   0.020342639</span></span>
<span><span class="co">## Same marginals as</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">e2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">e3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;             (Intercept)</span></span>
<span><span class="co">#&gt; (Intercept)  0.01004919</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;             (Intercept)</span></span>
<span><span class="co">#&gt; (Intercept)  0.02034264</span></span></code></pre></div>
<p>Note, it is also possible to directly specify the id-variables in the <code>merge</code> call:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/internal.html">merge</a></span><span class="op">(</span><span class="va">e2</span>, <span class="va">e3</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">dw</span><span class="op">$</span><span class="va">id</span>, <span class="va">dwc</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;               Estimate Std.Err     2.5%  97.5% P-value</span></span>
<span><span class="co">#&gt; (Intercept)     0.1402  0.1002 -0.05625 0.3367 0.16186</span></span>
<span><span class="co">#&gt; ─────────────                                         </span></span>
<span><span class="co">#&gt; (Intercept).1   0.2615  0.1426 -0.01807 0.5410 0.06676</span></span></code></pre></div>
<p>In the above example the <code>id</code> argument defines the identifier that makes it possible to link the rows in the different IFs that should be glued together. If omitted then the <code>id</code> will automatically be extracted from the model-specific <code>IC</code> method (deriving it from the original data.frame used for estimating the model). This automatically works with all models and <code>IC</code> methods described in this document.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/IC.html">IC</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   (Intercept)</span></span>
<span><span class="co">#&gt; 1   -2.150532</span></span>
<span><span class="co">#&gt; 2    1.869154</span></span>
<span><span class="co">#&gt; 3   -2.150532</span></span>
<span><span class="co">#&gt; 4    1.869154</span></span>
<span><span class="co">#&gt; 5   -2.150532</span></span>
<span><span class="co">#&gt; 6    1.869154</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;               (Intercept) (Intercept).1</span></span>
<span><span class="co">#&gt; (Intercept)   0.010049191   0.002102598</span></span>
<span><span class="co">#&gt; (Intercept).1 0.002102598   0.020342639</span></span>
<span><span class="op">(</span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span><span class="va">rownames</span> <span class="op"><a href="../reference/op_concat.html">%++%</a></span> <span class="va">head</span> <span class="op"><a href="../reference/op_concat.html">%++%</a></span> <span class="va">IC</span><span class="op">)</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "1"   "10"  "100" "101" "102" "103"</span></span></code></pre></div>
<p>To force that the id variables are not overlapping between the merged model objects, i.e., assuming that there is complete independence between the estimates, the argument <code>id=NULL</code> can be used</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/internal.html">merge</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, id <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="op">(</span><span class="va">Print</span> <span class="op"><a href="../reference/op_concat.html">%++%</a></span> <span class="va">IC</span><span class="op">)</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;     (Intercept) a          (Intercept).1</span></span>
<span><span class="co">#&gt; 1    1.104e-15   5.128e+00  0.000e+00   </span></span>
<span><span class="co">#&gt; 2    1.104e-15   5.128e+00  0.000e+00   </span></span>
<span><span class="co">#&gt; 3   -7.547e+00   7.547e+00  0.000e+00   </span></span>
<span><span class="co">#&gt; 4   -7.547e+00   7.547e+00  0.000e+00   </span></span>
<span><span class="co">#&gt; 5   -2.200e-15  -1.600e+01  0.000e+00   </span></span>
<span><span class="co">#&gt; ---                                     </span></span>
<span><span class="co">#&gt; 796  0.000       0.000      3.738       </span></span>
<span><span class="co">#&gt; 797  0.000       0.000      3.738       </span></span>
<span><span class="co">#&gt; 798  0.000       0.000     -4.301       </span></span>
<span><span class="co">#&gt; 799  0.000       0.000     -4.301       </span></span>
<span><span class="co">#&gt; 800  0.000       0.000     -4.301</span></span>
<span><span class="fu"><a href="../reference/internal.html">merge</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, id <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 (Intercept)             a (Intercept).1</span></span>
<span><span class="co">#&gt; (Intercept)    2.079760e-02 -2.079760e-02 -1.600942e-29</span></span>
<span><span class="co">#&gt; a             -2.079760e-02  4.720777e-02 -1.554863e-25</span></span>
<span><span class="co">#&gt; (Intercept).1 -1.600942e-29 -1.554863e-25  1.004919e-02</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="renaming-and-subsetting-parameters">Renaming and subsetting parameters<a class="anchor" aria-label="anchor" href="#renaming-and-subsetting-parameters"></a>
</h3>
<p>To only keep a subset of the parameters the <code>keep</code> argument can be used.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/internal.html">merge</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(Intercept)"</span>, <span class="st">"(Intercept).1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;               Estimate Std.Err     2.5%   97.5% P-value</span></span>
<span><span class="co">#&gt; (Intercept)    -0.1861  0.1442 -0.46876 0.09655  0.1969</span></span>
<span><span class="co">#&gt; (Intercept).1   0.1402  0.1002 -0.05625 0.33671  0.1619</span></span></code></pre></div>
<p>The argument can be given either as character vector or a vector of indices:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/internal.html">merge</a></span><span class="op">(</span><span class="va">g1</span>,<span class="va">g2</span>, keep<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;               Estimate Std.Err     2.5%   97.5% P-value</span></span>
<span><span class="co">#&gt; (Intercept)    -0.1861  0.1442 -0.46876 0.09655  0.1969</span></span>
<span><span class="co">#&gt; (Intercept).1   0.1402  0.1002 -0.05625 0.33671  0.1619</span></span></code></pre></div>
<p>or as a vector of perl-style regular expressions</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/internal.html">merge</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, keep <span class="op">=</span> <span class="st">"cept"</span>, regex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;               Estimate Std.Err     2.5%   97.5% P-value</span></span>
<span><span class="co">#&gt; (Intercept)    -0.1861  0.1442 -0.46876 0.09655  0.1969</span></span>
<span><span class="co">#&gt; (Intercept).1   0.1402  0.1002 -0.05625 0.33671  0.1619</span></span>
<span><span class="fu"><a href="../reference/internal.html">merge</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"\\)$"</span>, <span class="st">"^a$"</span><span class="op">)</span>, regex <span class="op">=</span> <span class="cn">TRUE</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Estimate Std.Err    2.5%   97.5%   P-value</span></span>
<span><span class="co">#&gt; (Intercept)  -0.1861  0.1442 -0.4688 0.09655 1.969e-01</span></span>
<span><span class="co">#&gt; a             1.3239  0.2173  0.8981 1.74978 1.105e-09</span></span></code></pre></div>
<p>When merging estimates unique parameter names are created. It is also possible to rename the parameters with the <code>labels</code> argument</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/internal.html">merge</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span>keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Estimate Std.Err     2.5%   97.5% P-value</span></span>
<span><span class="co">#&gt; a  -0.1861  0.1442 -0.46876 0.09655  0.1969</span></span>
<span><span class="co">#&gt; c   0.1402  0.1002 -0.05625 0.33671  0.1619</span></span>
<span><span class="fu"><a href="../reference/internal.html">merge</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>,</span>
<span>      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span>,</span>
<span>      keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"c"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   Estimate Std.Err     2.5%   97.5% P-value</span></span>
<span><span class="co">#&gt; a  -0.1861  0.1442 -0.46876 0.09655  0.1969</span></span>
<span><span class="co">#&gt; c   0.1402  0.1002 -0.05625 0.33671  0.1619</span></span>
<span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g1</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Estimate Std.Err    2.5%   97.5%   P-value</span></span>
<span><span class="co">#&gt; a  -0.1861  0.1442 -0.4688 0.09655 1.969e-01</span></span>
<span><span class="co">#&gt; b   1.3239  0.2173  0.8981 1.74978 1.105e-09</span></span></code></pre></div>
<p>Finally, the <code>subset</code> argument can be used to subset the parameters and IFs before the actual merging is being done</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/internal.html">merge</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, subset<span class="op">=</span><span class="st">"(Intercept)"</span><span class="op">)</span></span>
<span><span class="co">#&gt;               Estimate Std.Err     2.5%   97.5% P-value</span></span>
<span><span class="co">#&gt; (Intercept)    -0.1861  0.1442 -0.46876 0.09655  0.1969</span></span>
<span><span class="co">#&gt; ─────────────                                          </span></span>
<span><span class="co">#&gt; (Intercept).1   0.1402  0.1002 -0.05625 0.33671  0.1619</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="clustered-data-non-iid-case">Clustered data (non-iid case)<a class="anchor" aria-label="anchor" href="#clustered-data-non-iid-case"></a>
</h3>
<p>Let <span class="math inline">\(Z_i = (Z_{i1},\ldots,Z_{iN_{i}})\)</span> and assume that <span class="math inline">\((Z_{i}, N_{i}) \sim P\)</span>, <span class="math inline">\(i=1,\ldots,n\)</span> are iid and <span class="math inline">\(N_i\!\perp\!\!\!\!\perp\!Z_{ij}\)</span>. The variables <span class="math inline">\(Z_{i1},\ldots,Z_{iN_{i}}\)</span> we assume are exchangeable but not necessarily independent. Define <span class="math inline">\(N = \sum_{i=1}^{n} N_i\)</span>, and assume that a parameter estimate, <span class="math inline">\(\widehat{\theta}\in\mathbb{R}^p\)</span> has the decomposition <span class="math display">\[
\sqrt{N}(\widehat{\theta}-\theta) =
\frac{1}{\sqrt{N}}
\sum_{i=1}^{n} \sum_{k=1}^{N_{i}} IC(Z_{ik}; P_{0}) + o_{P}(1).
\]</span> It then follows that <span class="math display">\[
\sqrt{n}(\widehat{\theta}-\theta) = 
\frac{1}{\sqrt{n}}
\sum_{i=1}^{n} \widetilde{\operatorname{IC}}(Z_{i}; P_{0}) + o_{P}(1)
\]</span> with <span class="math inline">\(\widetilde{\operatorname{IC}}(Z_{i}; P_{0}) = \sum_{k=1}^{N_{i}} \frac{n}{N}IC(Z_{ik}; P_{0})\)</span>, <span class="math inline">\(i=1,\ldots,n\)</span> which are iid an therefore admits the usual CLT to derive the asymptotic variance of <span class="math inline">\(\widehat{\theta}\)</span>. Turning back to the example data, we can estimate the marginal model</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">a</span> <span class="op">+</span> <span class="va">w</span> <span class="op">+</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">dl</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The asymptotic variance estimate ignoring that the observations are not independent is not consistent. Instead we can calculate the cluster robust standard errors from the above iid decomposition</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g0</span>, id<span class="op">=</span><span class="va">dl</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Estimate Std.Err    2.5%   97.5%   P-value</span></span>
<span><span class="co">#&gt; (Intercept)  -0.1147 0.09351 -0.2979 0.06862 2.201e-01</span></span>
<span><span class="co">#&gt; a             1.0178 0.13016  0.7627 1.27288 5.303e-15</span></span>
<span><span class="co">#&gt; w             0.9825 0.07421  0.8370 1.12791 5.278e-40</span></span>
<span><span class="co">#&gt; x             0.9485 0.07835  0.7949 1.10203 9.976e-34</span></span></code></pre></div>
<p>We can confirm that this situation is equivalent to the variance estimates we obtain from a GEE marginal model with working independence correlation structure <span class="citation">(Halekoh, Højsgaard, and Yan 2006)</span></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gee0</span> <span class="op">&lt;-</span> <span class="fu">geepack</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geepack/man/geeglm.html" class="external-link">geeglm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">a</span> <span class="op">+</span> <span class="va">w</span> <span class="op">+</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">dl</span>, id <span class="op">=</span> <span class="va">dl</span><span class="op">$</span><span class="va">id</span>, family<span class="op">=</span><span class="va">binomial</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gee0</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; geepack::geeglm(formula = y ~ a + w + x, family = binomial, data = dl, </span></span>
<span><span class="co">#&gt;     id = dl$id)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate  Std.err    Wald Pr(&gt;|W|)    </span></span>
<span><span class="co">#&gt; (Intercept) -0.11466  0.09351   1.504     0.22    </span></span>
<span><span class="co">#&gt; a            1.01777  0.13016  61.145 5.33e-15 ***</span></span>
<span><span class="co">#&gt; w            0.98246  0.07421 175.250  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; x            0.94845  0.07835 146.523  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation structure = independence </span></span>
<span><span class="co">#&gt; Estimated Scale Parameters:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Estimate Std.err</span></span>
<span><span class="co">#&gt; (Intercept)   0.9538   0.098</span></span>
<span><span class="co">#&gt; Number of clusters:   400  Maximum cluster size: 4</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="computational-aspects">Computational aspects<a class="anchor" aria-label="anchor" href="#computational-aspects"></a>
</h3>
<p>Working with large and potentially multiple different IFs can be memory-intensive. A remedy is to use the idea of aggregating the IFs by introducing a random coarser grouping variable. Following the same arguments as in the previous section, the aggregated IF will still be iid and allows us to estimate the asymptotic variance. Obviously, the same grouping must be used across estimates when combining IFs.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1e5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">2e2</span> <span class="co">## Number of aggregated groups, the number of observations in the new IF</span></span>
<span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/csplit.html">foldr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="va">N</span>, list<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Print.html">Print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     [,1]</span></span>
<span><span class="co">#&gt; 1   500 </span></span>
<span><span class="co">#&gt; 2   500 </span></span>
<span><span class="co">#&gt; 3   500 </span></span>
<span><span class="co">#&gt; 4   500 </span></span>
<span><span class="co">#&gt; 5   500 </span></span>
<span><span class="co">#&gt; ---     </span></span>
<span><span class="co">#&gt; 196 500 </span></span>
<span><span class="co">#&gt; 197 500 </span></span>
<span><span class="co">#&gt; 198 500 </span></span>
<span><span class="co">#&gt; 199 500 </span></span>
<span><span class="co">#&gt; 200 500</span></span>
<span></span>
<span><span class="co">## Aggregated IF</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, id <span class="op">=</span> <span class="va">id</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt; 18992 bytes</span></span>
<span><span class="va">e</span></span>
<span><span class="co">#&gt;     Estimate Std.Err      2.5%    97.5% P-value</span></span>
<span><span class="co">#&gt; p1 -0.002244 0.00332 -0.008751 0.004263  0.4991</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="if-building-blocks-transformations-and-the-delta-theorem">IF building blocks: transformations and the delta theorem<a class="anchor" aria-label="anchor" href="#if-building-blocks-transformations-and-the-delta-theorem"></a>
</h2>
<p>Let <span class="math inline">\(\phi\colon \mathbb{R}^p\to\mathbb{R}^m\)</span> be differentiable at <span class="math inline">\(\theta\)</span> and assume that <span class="math inline">\(\widehat{\theta}_n\)</span> is RAL estimator with IF given by <span class="math inline">\(\operatorname{IC}(\cdot; P_{0})\)</span> such that <span class="math display">\[\begin{align*} 
\sqrt{n}(\widehat{\theta}_n - \theta) =
\frac{1}{\sqrt{n}}\sum_{i=1}^n \operatorname{IC}(Z_i; P_{0}) + o_{P}(1), 
\end{align*}\]</span> then by the delta method <span class="citation">(Vaart 1998 Theorem 3.1)</span> <span class="math display">\[\begin{align*} 
\sqrt{n}\{\phi(\widehat{\theta}_n) - \phi(\theta)\}  =
\frac{1}{\sqrt{n}}\sum_{i=1}^n \nabla\phi(\theta)\operatorname{IC}(Z_i; P_{0}) + o_{P}(1), 
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\phi\colon \theta\mapsto (\phi_{1}(\theta),\ldots,\phi_{m}(\theta))^\top\)</span> and <span class="math inline">\(\nabla\)</span> is the partial derivative operator <span class="math display">\[\begin{align*}
\nabla\phi(\theta) = 
\begin{pmatrix}
\tfrac{\partial}{\partial\theta_1}\phi_1(\theta) &amp; \cdots &amp;
\tfrac{\partial}{\partial\theta_p}\phi_1(\theta) \\
\vdots &amp; \ddots &amp; \vdots \\
\tfrac{\partial}{\partial\theta_1}\phi_m(\theta) &amp; \cdots &amp;
\tfrac{\partial}{\partial\theta_p}\phi_m(\theta) \\
\end{pmatrix}.
\end{align*}\]</span></p>
<p>Together with the ability to derive the joint IF from marginal IFs, this provides us with a powerful tool for constructing new estimates using the IFs as the fundamental building blocks.</p>
<p>To apply the delta method the transformation of the parameters function must be supplied to the <code>estimate</code> method (argument <code>f</code>)</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">sum</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Estimate Std.Err   2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; p1    1.138  0.1625 0.8193 1.456 2.532e-12</span></span>
<span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># named list</span></span>
<span><span class="co">#&gt;   Estimate Std.Err   2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; a    1.138  0.1625 0.8193 1.456 2.532e-12</span></span>
<span><span class="co">## Multiple parameters</span></span>
<span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, inv <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;               Estimate Std.Err    2.5%   97.5%   P-value</span></span>
<span><span class="co">#&gt; (Intercept)    -0.1861  0.1442 -0.4688 0.09655 1.969e-01</span></span>
<span><span class="co">#&gt; a               1.3239  0.2173  0.8981 1.74978 1.105e-09</span></span>
<span><span class="co">#&gt; (Intercept).1   3.5721  0.7289  2.1435 5.00062 9.539e-07</span></span>
<span><span class="co">#&gt; inv.a           0.7553  0.1240  0.5124 0.99828 1.105e-09</span></span>
<span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">exp</span><span class="op">)</span>         </span>
<span><span class="co">#&gt;             Estimate Std.Err   2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; (Intercept)   0.8302  0.1197 0.5955 1.065 4.087e-12</span></span>
<span><span class="co">#&gt; a             3.7582  0.8166 2.1578 5.359 4.175e-06</span></span></code></pre></div>
<p>The gradient can be provided as the attribute <code>grad</code> and otherwise numerical differentiation is applied.</p>
<div class="section level3">
<h3 id="example-pearson-correlation">Example: Pearson correlation<a class="anchor" aria-label="anchor" href="#example-pearson-correlation"></a>
</h3>
<p>As a simple toy example consider the problem of estimating the covariance of two variables <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> <span class="math display">\[\begin{align*}
\widehat{\mathbb{C}\!\text{ov}}(X_1,X_2) = \mathbb{P}_n(X_1-\mathbb{P}_n X_1)(Y_1-\mathbb{P}_n Y_1).
\end{align*}\]</span> It is easily verified that the IF of the sample estimate of <span class="math inline">\((\mathbb{E}X_{1}, \mathbb{E}X_{2}, \mathbb{E}\{X_{1}X_{2}\})^\top\)</span> given by is <span class="math inline">\(\operatorname{IC}(X1,X2; P_{0}) = (X_{1}-\mathbb{E}X_{1}, X_{2}-\mathbb{E}X_{2}, X_{1}X_{2}-\mathbb{E}\{X_{1}X_{2}\})^\top\)</span>. By the delta theorem with <span class="math inline">\(\phi(x,y,z) = z-xy\)</span> we have <span class="math inline">\(\nabla\phi(x,y,z) = (-y -x 1)\)</span> and thus the IF for the sample covariance estimate becomes <span class="math display">\[\begin{align*}
\operatorname{IC}_{x_1, x_2}(X_1, X_2; P_{0}) = (X_1 - \mathbb{E}X_1)(X_2 - \mathbb{E}X_2) - \mathbb{C}\!\text{ov}(X_1,X_2)
\end{align*}\]</span></p>
<p>We can implement this directly using the <code>estimate</code> function via the <code>IC</code> argument which allows us to provide a user-specificed IF and with the point estimate given by the <code>coef</code> argument</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Cov</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="va">y</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span></span>
<span>      coef <span class="op">=</span> <span class="va">est</span>,</span>
<span>      IC <span class="op">=</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">est</span>,</span>
<span>      <span class="va">...</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dw</span>, <span class="fu">Cov</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Estimate Std.Err     2.5%  97.5% P-value</span></span>
<span><span class="co">#&gt;  0.004043 0.04976 -0.09349 0.1016  0.9352</span></span></code></pre></div>
<p>As an illustration we could also derive this estimate from simpler building blocks of <span class="math inline">\(\mathbb{E}X_{1}\)</span>, <span class="math inline">\(\mathbb{E}X_{2}\)</span>, and <span class="math inline">\(\mathbb{E}(X_{1}X_{2})\)</span>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x1</span> <span class="op">*</span> <span class="va">x2</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">dw</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ex1"</span>, <span class="st">"Ex2"</span>, <span class="st">"Ex1x2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">e1</span></span>
<span><span class="co">#&gt;        Estimate Std.Err     2.5%   97.5% P-value</span></span>
<span><span class="co">#&gt; Ex1    0.038089 0.04842 -0.05681 0.13298  0.4315</span></span>
<span><span class="co">#&gt; Ex2   -0.037026 0.05187 -0.13869 0.06464  0.4753</span></span>
<span><span class="co">#&gt; Ex1x2  0.002633 0.05003 -0.09541 0.10068  0.9580</span></span>
<span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">e1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, cov<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">Ex1x2</span> <span class="op">-</span> <span class="va">Ex2</span><span class="op">*</span> <span class="va">Ex1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Estimate Std.Err     2.5%   97.5% P-value</span></span>
<span><span class="co">#&gt; Ex1    0.038089 0.04842 -0.05681 0.13298  0.4315</span></span>
<span><span class="co">#&gt; Ex2   -0.037026 0.05187 -0.13869 0.06464  0.4753</span></span>
<span><span class="co">#&gt; Ex1x2  0.002633 0.05003 -0.09541 0.10068  0.9580</span></span>
<span><span class="co">#&gt; cov    0.004043 0.04976 -0.09349 0.10158  0.9352</span></span></code></pre></div>
<p>The variance estimates can be estimated in the same way and the combined estimates be used to estimate the correlation</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dw</span>, <span class="fu">Cov</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, labels <span class="op">=</span> <span class="st">"c"</span>, id <span class="op">=</span> <span class="va">id</span><span class="op">)</span> <span class="op">+</span></span>
<span>               <span class="fu">Cov</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x1</span>, labels <span class="op">=</span> <span class="st">"v1"</span>, id <span class="op">=</span> <span class="va">id</span><span class="op">)</span> <span class="op">+</span></span>
<span>               <span class="fu">Cov</span><span class="op">(</span><span class="va">x2</span>, <span class="va">x2</span>, labels <span class="op">=</span> <span class="st">"v2"</span>, id <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">e2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rho <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rho</span></span>
<span><span class="co">#&gt;     Estimate Std.Err     2.5%  97.5% P-value</span></span>
<span><span class="co">#&gt; rho 0.004025 0.04953 -0.09306 0.1011  0.9352</span></span></code></pre></div>
<p>by using a variance stabilizing transformation, Fishers <span class="math inline">\(z\)</span>-transform <span class="citation">(Lehmann and Romano 2023)</span>, <span class="math inline">\(z = \operatorname{arctanh}(\widehat{\rho}) = \frac{1}{2}\log\left(\frac{1+\widehat{\rho}}{1-\widehat{\rho}}\right)\)</span>, confidence limits with general better coverage can be obtained</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">rho</span>, <span class="va">atanh</span>, back.transform <span class="op">=</span> <span class="va">tanh</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Estimate Std.Err     2.5%  97.5% P-value</span></span>
<span><span class="co">#&gt; rho 0.004025         -0.09279 0.1008  0.9352</span></span></code></pre></div>
<p>The confidence limits are calculated on the <span class="math inline">\(\operatorname{arctanh}\)</span>-scale and transformed back to the original correlation scale via the <code>back.transform</code> argument. In this case, where the estimates are far away from the boundary of the parameter space, the variance stabilizing transform does almost not have any impact, and the confidence limits agrees with the original symmetric confidence limits.</p>
</div>
<div class="section level3">
<h3 id="todo-example-survival">TODO Example: survival<a class="anchor" aria-label="anchor" href="#todo-example-survival"></a>
</h3>
</div>
<div class="section level3">
<h3 id="linear-contrasts-and-hypothesis-testing">Linear contrasts and hypothesis testing<a class="anchor" aria-label="anchor" href="#linear-contrasts-and-hypothesis-testing"></a>
</h3>
<p>An important special case of parameter transformations are linear transformations. A particular interest may be formulated around testing null-hypotheses of the form <span class="math display">\[\begin{align*}
H_0\colon\quad \mathbf{B}\theta = \mathbf{b}_0
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\mathbf{B}\in\mathbb{R}^{m\times p}\)</span> is a matrix of estimable contrasts and <span class="math inline">\(\mathbf{b}_0\in\mathbb{R}^{m}\)</span>.</p>
<p>As an example consider marginal models for the binary response variables <span class="math inline">\(Y_1, Y_2, Y_3, Y_4\)</span></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">a</span>, <span class="va">y2</span> <span class="op">~</span> <span class="va">a</span>, <span class="va">y3</span> <span class="op">~</span> <span class="va">a</span><span class="op">)</span>, <span class="co">#, y4 ~ a+x4),</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">f</span>, family <span class="op">=</span> <span class="va">binomial</span>, data <span class="op">=</span> <span class="va">dw</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">merge</span>, <span class="va">g</span><span class="op">)</span></span>
<span><span class="va">gg</span></span>
<span><span class="co">#&gt;               Estimate Std.Err    2.5%    97.5%   P-value</span></span>
<span><span class="co">#&gt; (Intercept)    -0.1861  0.1442 -0.4688  0.09655 1.969e-01</span></span>
<span><span class="co">#&gt; a               1.3239  0.2173  0.8981  1.74978 1.105e-09</span></span>
<span><span class="co">#&gt; ─────────────                                            </span></span>
<span><span class="co">#&gt; (Intercept).1  -0.6168  0.1505 -0.9117 -0.32185 4.152e-05</span></span>
<span><span class="co">#&gt; a.1             1.5060  0.2148  1.0849  1.92712 2.385e-12</span></span>
<span><span class="co">#&gt; ─────────────                                            </span></span>
<span><span class="co">#&gt; (Intercept).2  -0.2938  0.2063 -0.6982  0.11064 1.545e-01</span></span>
<span><span class="co">#&gt; a.2             1.1047  0.2962  0.5242  1.68515 1.914e-04</span></span></code></pre></div>
<p>A linear transformation can be specified via the <code>f</code> as a matrix argument instead of function object</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">gg</span>, <span class="va">B</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Estimate Std.Err    2.5%  97.5% P-value</span></span>
<span><span class="co">#&gt; [a] - [a.1]  -0.1821  0.3003 -0.7707 0.4065  0.5443</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Null Hypothesis: </span></span>
<span><span class="co">#&gt;   [a] - [a.1] = 0</span></span></code></pre></div>
<p>The <span class="math inline">\(\mathbf{b}_0\)</span> vector (default assumed to be zero) can be specified via the <code>null</code> argument</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">gg</span>, <span class="va">B</span>, null<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Estimate Std.Err    2.5%  97.5%   P-value</span></span>
<span><span class="co">#&gt; [a] - [a.1]  -0.1821  0.3003 -0.7707 0.4065 8.281e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Null Hypothesis: </span></span>
<span><span class="co">#&gt;   [a] - [a.1] = 1</span></span></code></pre></div>
<p>For testing multiple hypotheses we use that <span class="math inline">\((\mathbf{B}\widehat{\theta}-\mathbf{b}_0)^{\top} (\mathbf{B}\widehat{\Sigma}\mathbf{B}^{\top})^{-1} (\mathbf{B}\widehat{\theta}-\mathbf{b}_0) \sim  \chi^2_{\operatorname{rank}(B)}\)</span> under the null hypothesis where <span class="math inline">\(\widehat{\Sigma}\)</span> is the estimated variance of <span class="math inline">\(\theta\)</span> (i.e., <code>vcov(gg)</code>)</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">gg</span>, <span class="va">B</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Estimate Std.Err    2.5%  97.5% P-value</span></span>
<span><span class="co">#&gt; [a] - [a.1]  -0.1821  0.3003 -0.7707 0.4065  0.5443</span></span>
<span><span class="co">#&gt; [a] - [a.2]   0.2192  0.3637 -0.4936 0.9321  0.5466</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Null Hypothesis: </span></span>
<span><span class="co">#&gt;   [a] - [a.1] = 0</span></span>
<span><span class="co">#&gt;   [a] - [a.2] = 0 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; chisq = 1.343, df = 2, p-value = 0.5109</span></span></code></pre></div>
<p>Such linear statistics can also be specified directly as expressions of the parameter names</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">gg</span>, <span class="va">a</span> <span class="op">+</span> <span class="va">a.1</span>, <span class="fl">2</span><span class="op">*</span><span class="va">a</span> <span class="op">-</span> <span class="va">a.2</span>, <span class="va">a</span>, null<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;              Estimate Std.Err   2.5% 97.5%  P-value</span></span>
<span><span class="co">#&gt; [a] + [a.1]     2.830  0.3107 2.2210 3.439 0.007557</span></span>
<span><span class="co">#&gt; 2[a] - [a.2]    1.543  0.5208 0.5224 2.564 0.296991</span></span>
<span><span class="co">#&gt; [a]             1.324  0.2173 0.8981 1.750 0.135985</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Null Hypothesis: </span></span>
<span><span class="co">#&gt;   [a] + [a.1] = 2</span></span>
<span><span class="co">#&gt;   2[a] - [a.2] = 1</span></span>
<span><span class="co">#&gt;   [a] = 1 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; chisq = 7.557, df = 3, p-value = 0.05612</span></span></code></pre></div>
<p>We refer to the function <code><a href="../reference/contr.html">lava::contr</a></code> and <code>lava::parsedesigns</code> for defining contrast matrices.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/contr.html">contr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    1   -1    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    1    0    0   -1    0</span></span></code></pre></div>
<p>A particular useful contrast is the following for considering all pairwise comparisons of different exposure estimates:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/contr.html">pairwise.diff</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    1   -1    0</span></span>
<span><span class="co">#&gt; [2,]    1    0   -1</span></span>
<span><span class="co">#&gt; [3,]    0    1   -1</span></span>
<span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">gg</span>, <span class="fu"><a href="../reference/contr.html">pairwise.diff</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, null<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, use<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;               Estimate Std.Err    2.5%  97.5%   P-value</span></span>
<span><span class="co">#&gt; [a] - [a.1]    -0.1821  0.3003 -0.7707 0.4065 8.281e-05</span></span>
<span><span class="co">#&gt; [a] - [a.2]     0.2192  0.3637 -0.4936 0.9321 3.182e-02</span></span>
<span><span class="co">#&gt; [a.1] - [a.2]   0.4013  0.3506 -0.2858 1.0885 8.773e-02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Null Hypothesis: </span></span>
<span><span class="co">#&gt;   [a] - [a.1] = 1</span></span>
<span><span class="co">#&gt;   [a] - [a.2] = 1</span></span>
<span><span class="co">#&gt;   [a.1] - [a.2] = 1 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; chisq = 11.96, df = 2, p-value = 0.002523</span></span></code></pre></div>
<p>When conducting multiple tests each at a nominal-level of <span class="math inline">\(\alpha\)</span> the overall type I error is not controlled at <span class="math inline">\(\alpha\)</span>-level.<br>
The influence function also allows for adjusting for multiple comparisons. Let <span class="math inline">\(Z_{1},\ldots,Z_{p}\)</span> denote <span class="math inline">\(Z\)</span>-statistics from <span class="math inline">\(p\)</span> distinct two-sided hypothesis tests which we will assume is asymptotically distributed under the null hypothesis as a zero-mean Gaussian distribution with correlation matrix <span class="math inline">\(R.\)</span> Let <span class="math inline">\(Z_{max} = \max_{i=1,\ldots,p} |Z_i|\)</span> then the family-wise error rate (FWER) under the null can be approximated by <span class="math display">\[ P(Z_{max} &gt; z) =
1-\int_{-z}^{z} \cdots \int_{-z}^{z} \phi_{R}(x_{1},\ldots,x_{p})
\,dx_{1}\cdots\,dx_{p} \]</span> where <span class="math inline">\(\phi_{R}\)</span> is the multivariate normal density function with mean 0 and variance given by the correlation matrix <span class="math inline">\(R\)</span>. The adjusted <span class="math inline">\(p\)</span>-values can then be calculated as <span class="math display">\[P(Z_{max} &gt;
\Phi^{-1}(1-p/2))\]</span> where <span class="math inline">\(\Phi\)</span> is the standard Gaussian CDF. As described in in <span class="citation">(Pipper, Ritz, and Bisgaard 2012)</span> the joint distribution of <span class="math inline">\(Z_{1},\ldots,Z_{p}\)</span> can be estimated from the IFs. This is implemented in the <code>p.correct</code> method</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">gg</span>, use<span class="op">=</span><span class="st">"^a"</span>, regex<span class="op">=</span><span class="cn">TRUE</span>, null<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/closed.testing.html">p.correct</a></span><span class="op">(</span><span class="va">gg0</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Estimate  P-value Adj.P-value</span></span>
<span><span class="co">#&gt; [a]      1.324 0.015891    0.046870</span></span>
<span><span class="co">#&gt; [a.1]    1.506 0.001015    0.003043</span></span>
<span><span class="co">#&gt; [a.2]    1.105 0.303571    0.661497</span></span>
<span><span class="co">#&gt; attr(,"adjusted.significance.level")</span></span>
<span><span class="co">#&gt; [1] 0.01698</span></span></code></pre></div>
<p>While this always yields a more powerful test compared to Bonferroni adjustments, a more powerful closed-testing procedure <span class="citation">(Marcus, Eric, and Gabriel 1976)</span>, can be generally obtained by considering all intersection hypotheses.</p>
<div class="figure">
<embed src="figs/closedtesting.pdf"></embed><p class="caption"><em>Figure: closed testing via Wald tests of all intersections hypotheses.</em></p>
</div>
<p>To reject the <span class="math inline">\(H_{1}\)</span> at an correct <span class="math inline">\(\alpha\)</span>-level we should test all intersection hypotheses involving <span class="math inline">\(H_{1}\)</span> and check if there all are rejected at the <span class="math inline">\(\alpha\)</span>-level. The adjusted <span class="math inline">\(p\)</span>-values can here be obtained as the maximum <span class="math inline">\(p\)</span>-value across all the composite hypothesis tests. Unfortunately, this only works for relatively few comparisons as the number of tests grows exponentially.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/closed.testing.html">closed.testing</a></span><span class="op">(</span><span class="va">gg0</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Estimate   P-value Adj.P-value</span></span>
<span><span class="co">#&gt; a      1.324 1.105e-09    0.033802</span></span>
<span><span class="co">#&gt; a.1    1.506 2.385e-12    0.003413</span></span>
<span><span class="co">#&gt; a.2    1.105 1.914e-04    0.303571</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="averaging">Averaging<a class="anchor" aria-label="anchor" href="#averaging"></a>
</h3>
<p>Some parameters of interest are expressed as averages over functions of the observed data and estimated parameters of a model. The asymptotic distribution can in some of these cases also be derived from the influence function. Let <span class="math inline">\(Z_{1},\ldots,Z_{n}\)</span> be iid observations, <span class="math inline">\(Z_{1}\sim P_{0}\)</span> and let <span class="math inline">\(X_{i}\subset Z_{i}\)</span>.</p>
<p>Assume that <span class="math inline">\(\widehat{\theta}\)</span> is RAL estimator of <span class="math inline">\(\theta\in\Omega\subset \mathbb{R}^{p}\)</span> <span class="math display">\[\sqrt{n}(\widehat{\theta}-\theta) = \frac{1}{\sqrt{n}}\sum_{i=1}^{n}\phi(Z_{i}; P_{0}) + o_{P}(1).
\]</span> Let <span class="math inline">\(f:\mathcal{X}\times\Omega\to\mathbb{R}\)</span> be continuous differentiable in <span class="math inline">\(\theta\)</span> <span class="math display">\[\sqrt{n}\{f(X; \widehat{\theta})-f(X; \theta)\} =
\frac{1}{\sqrt{n}}\nabla_{\theta}f(X;\theta)\sum_{i=1}^{n}\phi(Z_{i}; P) + o_{P}(1).
\]</span></p>
<p>Let <span class="math inline">\(\Psi = P_{0}f(X;\theta)\)</span> and <span class="math inline">\(\widehat{\Psi} = P_{n} f(X;\widehat{\theta})\)</span>. <span class="math inline">\(P_{0}\)</span> and <span class="math inline">\(P_{n}\)</span> are here everywhere the integrals wrt. <span class="math inline">\(X\)</span>. It is easily verified that <span class="math display">\[\begin{align*}
\widehat{\Psi}-\Psi &amp;= (P_{n}-P_{0})(f(X; \theta)-\Psi) + P[f(X;\widehat{\theta})-f(X;\theta)] \\
&amp;\quad + (P_{n}-P_{0})[f(X;\widehat{\theta})-f(X;\theta)]
\end{align*}\]</span></p>
<p>From Lemma 19.24 <span class="citation">(Vaart 1998)</span> it follows that for the last term <span class="math display">\[\begin{align*}
\sqrt{n}(P_{n}-P_{0})[f(X;\widehat{\theta})-f(X;\theta)] = o_{P}(1)
\end{align*}\]</span> when <span class="math inline">\(f\)</span> for example is Lipschitz and more generally when <span class="math inline">\(f(X;\theta)\)</span> forms a <span class="math inline">\(P_{0}\)</span>-Donsker class.</p>
<p>It therefore follows that <span class="math display">\[\begin{align*}
\sqrt{n}(\widehat{\Psi}-\Psi) &amp;= \sqrt{n}P_{n}(f(X; \theta)-\Psi) +
\frac{1}{\sqrt{n}}P\nabla_{\theta}f(X;\theta)\sum_{i=1}^{n}\phi(Z_{i}; P_{0}) + o_{P}(1) \\
&amp;=
\frac{1}{\sqrt{n}}\sum_{i=1}^{n}\{f(X;\theta)-\Psi\} +
\frac{1}{\sqrt{n}}P\nabla_{\theta}f(X;\theta)\sum_{i=1}^{n}\phi(Z_{i}, P_{0}) + o_{P}(1)
\end{align*}\]</span> Hence the IF for <span class="math inline">\(\widehat{\Psi}\)</span> becomes <span class="math display">\[
IC(Z; P_{0}) = f(X;\theta)-\Psi +
[P_{0}\nabla_{\theta}f(X;\theta)]\phi(Z).
\]</span></p>
<p>Turning back to the example we can estimate the logistic regression model <span class="math inline">\(\operatorname{logit}(E\{Y_1 | A,X_1,W\}) = \beta_0 + \beta_a A + \beta_{x_1} X_1 + \beta_w W\)</span>, and from this we want to estimate the target parameter <span class="math display">\[
\theta(P) = \mathbb{E}_{P}[E(Y\mid A=1, X_{1}, W)].
\]</span> To do this we need first to estimate the model and then define a function that gives the predicted probability <span class="math inline">\(\mathbb{P}(Y=1\mid,A=a,X_{1},W)\)</span> for any observed values of <span class="math inline">\(X_1,W\)</span> but with the treatment variable <span class="math inline">\(A\)</span> kept fixed at the value <span class="math inline">\(1\)</span></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">a</span> <span class="op">+</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">w</span>, data<span class="op">=</span><span class="va">dw</span>, family<span class="op">=</span><span class="va">binomial</span><span class="op">)</span></span>
<span><span class="va">pr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="../reference/internal.html">expit</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">p</span><span class="op">[</span><span class="st">"a"</span><span class="op">]</span> <span class="op">+</span> <span class="va">p</span><span class="op">[</span><span class="st">"x1"</span><span class="op">]</span><span class="op">*</span><span class="va">x1</span> <span class="op">+</span> <span class="va">p</span><span class="op">[</span><span class="st">"w"</span><span class="op">]</span><span class="op">*</span><span class="va">w</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">pr</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, <span class="va">dw</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8307 0.9651 0.4234 0.9337 0.7669 0.4834</span></span></code></pre></div>
<p>The target parameter can now be estimated with the syntax</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/csplit.html">foldr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NROW</a></span><span class="op">(</span><span class="va">dw</span><span class="op">)</span>, <span class="fl">100</span>, list<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">ea</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">pr</span>, average<span class="op">=</span><span class="cn">TRUE</span>, id<span class="op">=</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="va">ea</span></span>
<span><span class="co">#&gt;     Estimate Std.Err   2.5%  97.5%    P-value</span></span>
<span><span class="co">#&gt; val   0.7006 0.02966 0.6425 0.7587 2.561e-123</span></span>
<span><span class="fu"><a href="../reference/IC.html">IC</a></span><span class="op">(</span><span class="va">ea</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;        val</span></span>
<span><span class="co">#&gt; 1 -0.41685</span></span>
<span><span class="co">#&gt; 2 -0.22444</span></span>
<span><span class="co">#&gt; 3  0.34679</span></span>
<span><span class="co">#&gt; 4  0.03143</span></span>
<span><span class="co">#&gt; 5  0.02478</span></span>
<span><span class="co">#&gt; 6 -0.61997</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-average-treatment-effects">Example: Average Treatment Effects<a class="anchor" aria-label="anchor" href="#example-average-treatment-effects"></a>
</h3>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu">targeted</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/targeted/man/cate.html" class="external-link">cate</a></span><span class="op">(</span><span class="va">a</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span></span>
<span>                     data <span class="op">=</span> <span class="va">dw</span>,</span>
<span>                     response_model <span class="op">=</span> <span class="va">y1</span> <span class="op">~</span> <span class="va">x1</span><span class="op">+</span><span class="va">w</span><span class="op">+</span><span class="va">a</span>,</span>
<span>                     propensity_model <span class="op">=</span> <span class="va">a</span> <span class="op">~</span> <span class="va">x1</span><span class="op">*</span><span class="va">w</span></span>
<span>                     <span class="op">)</span></span>
<span><span class="va">a1</span></span>
<span><span class="co">#&gt;  Estimate Std.Err    2.5%  97.5%   P-value</span></span>
<span><span class="co">#&gt;    0.1883 0.05588 0.07879 0.2978 0.0007517</span></span>
<span><span class="fu"><a href="../reference/IC.html">IC</a></span><span class="op">(</span><span class="va">a1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;          </span></span>
<span><span class="co">#&gt; 1  0.3429</span></span>
<span><span class="co">#&gt; 2 -0.1005</span></span>
<span><span class="co">#&gt; 3  0.7113</span></span>
<span><span class="co">#&gt; 4  1.5886</span></span>
<span><span class="co">#&gt; 5 -1.5870</span></span>
<span><span class="co">#&gt; 6  0.6843</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="sessioninfo">SessionInfo<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] survival_3.5-7 lava_1.7.4    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] xfun_0.41            bslib_0.6.1          targeted_0.4        </span></span>
<span><span class="co">#&gt;  [4] lattice_0.21-9       numDeriv_2016.8-1.1  vctrs_0.6.5         </span></span>
<span><span class="co">#&gt;  [7] tools_4.3.2          generics_0.1.3       parallel_4.3.2      </span></span>
<span><span class="co">#&gt; [10] tibble_3.2.1         fansi_1.0.6          pkgconfig_2.0.3     </span></span>
<span><span class="co">#&gt; [13] Matrix_1.6-4         data.table_1.14.10   desc_1.4.3          </span></span>
<span><span class="co">#&gt; [16] optimx_2023-10.21    lifecycle_1.0.4      compiler_4.3.2      </span></span>
<span><span class="co">#&gt; [19] stringr_1.5.1        textshaping_0.3.7    codetools_0.2-19    </span></span>
<span><span class="co">#&gt; [22] htmltools_0.5.7      sass_0.4.8           yaml_2.3.8          </span></span>
<span><span class="co">#&gt; [25] pracma_2.4.4         nloptr_2.0.3         pkgdown_2.0.7       </span></span>
<span><span class="co">#&gt; [28] pillar_1.9.0         jquerylib_0.1.4      tidyr_1.3.0         </span></span>
<span><span class="co">#&gt; [31] MASS_7.3-60          cachem_1.0.8         parallelly_1.36.0   </span></span>
<span><span class="co">#&gt; [34] timereg_2.0.5        tidyselect_1.2.0     digest_0.6.33       </span></span>
<span><span class="co">#&gt; [37] mvtnorm_1.2-4        stringi_1.8.3        future_1.33.0       </span></span>
<span><span class="co">#&gt; [40] dplyr_1.1.4          purrr_1.0.2          listenv_0.9.0       </span></span>
<span><span class="co">#&gt; [43] geepack_1.3.9        splines_4.3.2        fastmap_1.1.1       </span></span>
<span><span class="co">#&gt; [46] grid_4.3.2           cli_3.6.2            magrittr_2.0.3      </span></span>
<span><span class="co">#&gt; [49] utf8_1.2.4           broom_1.0.5          future.apply_1.11.0 </span></span>
<span><span class="co">#&gt; [52] mets_1.3.3           backports_1.4.1      rmarkdown_2.25      </span></span>
<span><span class="co">#&gt; [55] lambda.r_1.2.4       globals_0.16.2       progressr_0.14.0    </span></span>
<span><span class="co">#&gt; [58] futile.logger_1.4.3  ragg_1.2.7           memoise_2.0.1       </span></span>
<span><span class="co">#&gt; [61] evaluate_0.23        knitr_1.45           rlang_1.1.2         </span></span>
<span><span class="co">#&gt; [64] futile.options_1.0.1 Rcpp_1.0.11          glue_1.6.2          </span></span>
<span><span class="co">#&gt; [67] formatR_1.14         jsonlite_1.8.8       R6_2.5.1            </span></span>
<span><span class="co">#&gt; [70] systemfonts_1.0.5    fs_1.6.3</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<div id="refs" class="references hanging-indent">
<div id="ref-bickel_effic_adapt_estim_semip_model">
<p>Bickel, Peter J., Chris A. J. Klaassen, Ya’Acov Ritov, and Jon A. Wellner. 1998. <em>Efficient and Adaptive Estimation for Semiparametric Models</em>. Springer.</p>
</div>
<div id="ref-r_geepack">
<p>Halekoh, Ulrich, Søren Højsgaard, and Jun Yan. 2006. “The R Package Geepack for Generalized Estimating Equations.” <em>Journal of Statistical Software</em> 15/2: 1–11. <a href="https://doi.org/10.18637/jss.v015.i02" class="external-link">https://doi.org/10.18637/jss.v015.i02</a>.</p>
</div>
<div id="ref-hines2022">
<p>Hines, Oliver, Oliver Dukes, Karla Diaz-Ordaz, and Stijn Vansteelandt. 2022. “Demystifying Statistical Learning Based on Efficient Influence Functions.” <em>The American Statistician</em>, February, 1–13. <a href="https://doi.org/10.1080/00031305.2021.2021984" class="external-link">https://doi.org/10.1080/00031305.2021.2021984</a>.</p>
</div>
<div id="ref-holst_budtzjorgensen_2013">
<p>Holst, K. K., and E. Budtz-Jørgensen. 2013. “Linear Latent Variable Models: The Lava-Package.” <em>Computational Statistics</em> 28 (4): 1385–1452. <a href="https://doi.org/10.1007/s00180-012-0344-y" class="external-link">https://doi.org/10.1007/s00180-012-0344-y</a>.</p>
</div>
<div id="ref-targetedlearning_2011">
<p>Laan, Mark J. van der, and Sherri Rose. 2011. <em>Targeted Learning. Causal Inference for Observational and Experimental Data</em>. Springer. <a href="https://doi.org/10.1007/978-1-4419-9782-1" class="external-link">https://doi.org/10.1007/978-1-4419-9782-1</a>.</p>
</div>
<div id="ref-lehmann2023_testing">
<p>Lehmann, E. L., and Joseph P. Romano. 2023. <em>Testing Statistical Hypotheses</em>. Fourth. Springer Texts in Statistics. New York: Springer. <a href="https://doi.org/10.1007/978-3-030-70578-7" class="external-link">https://doi.org/10.1007/978-3-030-70578-7</a>.</p>
</div>
<div id="ref-marcus1976">
<p>Marcus, Ruth, Pertiz Eric, and K. R. Gabriel. 1976. “On Closed Testing Procedures with Special Reference to Ordered Analysis of Variance.” <em>Biometrika</em> 63 (3): 655–60. <a href="https://doi.org/10.1093/biomet/63.3.655" class="external-link">https://doi.org/10.1093/biomet/63.3.655</a>.</p>
</div>
<div id="ref-RitzPipper_multcomp">
<p>Pipper, Christian B., Christian Ritz, and Hans Bisgaard. 2012. “A Versatile Method for Confirmatory Evaluation of the Effects of a Covariate in Multiple Models.” <em>Journal of the Royal Statistical Society C, Appl. Statist.</em> 61 (2): 315–26. <a href="https://doi.org/10.1111/j.1467-9876.2011.01005.x" class="external-link">https://doi.org/10.1111/j.1467-9876.2011.01005.x</a>.</p>
</div>
<div id="ref-therneau00surv">
<p>Therneau, T., and P. Grambsch. 2000. <em>Modeling Survival Data: Extending the Cox Model</em>. Springer-Verlag, New York. <a href="https://doi.org/10.1007/978-1-4757-3294-8" class="external-link">https://doi.org/10.1007/978-1-4757-3294-8</a>.</p>
</div>
<div id="ref-tsiatis2006semiparametric">
<p>Tsiatis, A. 2006. <em>Semiparametric Theory and Missing Data</em>. Springer Series in Statistics. Springer New York. <a href="https://doi.org/10.1007/0-387-37345-4" class="external-link">https://doi.org/10.1007/0-387-37345-4</a>.</p>
</div>
<div id="ref-vaart_1998_asymp">
<p>Vaart, A. W. van der. 1998. <em>Asymptotic Statistics</em>. <em>Cambridge University Press, Cambridge</em>. <a href="https://doi.org/10.1017/CBO9780511802256" class="external-link">https://doi.org/10.1017/CBO9780511802256</a>.</p>
</div>
<div id="ref-r_sandwich">
<p>Zeileis, Achim, Susanne Köll, and Nathaniel Graham. 2020. “Various Versatile Variances: An Object-Oriented Implementation of Clustered Covariances in R.” <em>Journal of Statistical Software</em> 95 (1): 1–36. <a href="https://doi.org/10.18637/jss.v095.i01" class="external-link">https://doi.org/10.18637/jss.v095.i01</a>.</p>
</div>
<div id="ref-zenglin2008">
<p>Zeng, Donglin, and D. Y. Lin. 2008. “Efficient Resampling Methods for Nonsmooth Estimating Functions.” <em>Biostatistics</em> 9 (2): 355–63. <a href="https://doi.org/10.1093/biostatistics/kxm034" class="external-link">https://doi.org/10.1093/biostatistics/kxm034</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Klaus K. Holst.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
