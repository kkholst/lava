<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimating partial correlations with lava • lava</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating partial correlations with lava">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lava</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/correlation.html">Estimating partial correlations with lava</a></li>
    <li><a class="dropdown-item" href="../articles/influencefunction.html">The Art of Influence</a></li>
    <li><a class="dropdown-item" href="../articles/nonlinear.html">Non-linear latent variable models and error-in-variable models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kkholst/lava/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimating partial correlations with lava</h1>
                        <h4 data-toc-skip class="author">Klaus Kähler
Holst</h4>
            
            <h4 data-toc-skip class="date">2025-10-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kkholst/lava/blob/main/vignettes/correlation.Rmd" class="external-link"><code>vignettes/correlation.Rmd</code></a></small>
      <div class="d-none name"><code>correlation.Rmd</code></div>
    </div>

    
    
<!-- correlation.Rmd is generated from correlation.org. Please edit that file -->
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow></mrow><annotation encoding="application/x-tex">
\newcommand{\arctanh}{\operatorname{arctanh}}
</annotation></semantics></math></p>
<p>This document illustrates how to estimate partial correlation
coefficients using <code>lava</code>.</p>
<p>Assume that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Y_{1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Y_{2}</annotation></semantics></math>
are conditionally normal distributed given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math>
with the following linear structure
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mn>1</mn></msub><mo>=</mo><msubsup><mi>𝛃</mi><mn>1</mn><mi>t</mi></msubsup><mi>𝐗</mi><mo>+</mo><msub><mi>ϵ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Y_1 = \mathbf{\beta}_1^{t}\mathbf{X} + \epsilon_1</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mn>2</mn></msub><mo>=</mo><msubsup><mi>𝛃</mi><mn>2</mn><mi>t</mi></msubsup><mi>𝐗</mi><mo>+</mo><msub><mi>ϵ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">Y_2 = \mathbf{\beta}_2^{t}\mathbf{X} + \epsilon_2</annotation></semantics></math>
with covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐗</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>X</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{X} = (X_1,\ldots,X_k)^{t}</annotation></semantics></math>
and measurement errors
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ϵ</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ϵ</mi><mn>2</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>𝚺</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mi>𝚺</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mi>ρ</mi><msub><mi>σ</mi><mn>1</mn></msub><msub><mi>σ</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>ρ</mi><msub><mi>σ</mi><mn>1</mn></msub><msub><mi>σ</mi><mn>2</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{pmatrix}
    \epsilon_{1} \\
    \epsilon_{2}
    \end{pmatrix} \sim \mathcal{N}\left(0, \mathbf{\Sigma} \right), \quad \mathbf{\Sigma}
    =
    \begin{pmatrix}
    \sigma_1^2 &amp; \rho\sigma_{1}\sigma_{2} \\
    \rho\sigma_{1}\sigma_{2} &amp; \sigma_2^2
    \end{pmatrix}.</annotation></semantics></math></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://kkholst.github.io/lava/" class="external-link">'lava'</a></span><span class="op">)</span></span>
<span><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lvm.html">lvm</a></span><span class="op">(</span><span class="va">y1</span><span class="op">+</span><span class="va">y2</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">y1</span> <span class="op">~</span><span class="op">~</span> <span class="va">y2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/labels-set.html">edgelabels</a></span><span class="op">(</span><span class="va">m0</span>, <span class="va">y1</span> <span class="op">+</span> <span class="va">y2</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">beta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">beta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/labels-set.html">edgelabels</a></span><span class="op">(</span><span class="va">m0</span>, <span class="va">y1</span> <span class="op">~</span> <span class="va">y2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">rho</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m0</span>, layoutType<span class="op">=</span><span class="st">"circo"</span><span class="op">)</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>Here we focus on inference with respect to the correlation parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>.</p>
<div class="section level2">
<h2 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h2>
<p>As an example, we will simulate data from this model with a single
covariate. First we load the necessary libraries:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://kkholst.github.io/lava/" class="external-link">'lava'</a></span><span class="op">)</span></span></code></pre></div>
<p>The model can be specified (here using the pipe notation) with the
following syntax where the correlation parameter here is given the label
‘<code>r</code>’:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lvm.html">lvm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/covariance.html">covariance</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">y2</span>, value<span class="op">=</span><span class="st">'r'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/regression-set.html">regression</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">+</span> <span class="va">y2</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p>To simulate from the model we can now simply use the <code>sim</code>
method. The parameters of the models are set through the argument
<code>p</code> which must be a named numeric vector of parameters of the
model. The parameter names can be inspected with the <code>coef</code>
method</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">m0</span>, labels<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;       m1       m2       p1       p2       p3       p4       p5 </span></span>
<span><span class="co">#&gt;     "y1"     "y2"   "y1~x"   "y2~x" "y1~~y1" "y2~~y2"      "r"</span></span></code></pre></div>
<p>The default simulation parameters are zero for all intercepts
(<code>y1</code>, <code>y2</code>) and one for all regression
coefficients (<code>y1~x</code>, <code>y2~x</code>) and residual
variance parameters (<code>y1~~y1</code>, <code>y2~~y2</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim.default.html">sim</a></span><span class="op">(</span><span class="va">m0</span>, <span class="fl">500</span>, p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>r<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span>, seed<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="co">#&gt;           y1         y2           x</span></span>
<span><span class="co">#&gt; 1  0.6452154  0.8677628  1.13496509</span></span>
<span><span class="co">#&gt; 2  1.1098723  0.9579211  1.11193185</span></span>
<span><span class="co">#&gt; 3 -2.2072258 -2.3171509 -0.87077763</span></span>
<span><span class="co">#&gt; 4  1.5684365  1.0675354  0.21073159</span></span>
<span><span class="co">#&gt; 5  0.8752209  1.0845932  0.06939565</span></span>
<span><span class="co">#&gt; 6 -1.5113072 -0.7477956 -1.66264885</span></span></code></pre></div>
<p>Under Gaussian and coarsening at random assumptions we can also
consistently estimate the correlation in the presence of censoring or
missing data. To illustrate this, we add left and right censored data
types to the model output using the <code>transform</code> method.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cens1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">threshold</span>,<span class="va">type</span><span class="op">=</span><span class="st">'right'</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">type</span><span class="op">==</span><span class="st">'left'</span><span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">threshold</span><span class="op">)</span>, <span class="va">x</span><span class="op">&gt;=</span><span class="va">threshold</span>, type<span class="op">=</span><span class="st">'left'</span><span class="op">)</span> <span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">threshold</span><span class="op">)</span>, <span class="va">x</span><span class="op">&lt;=</span><span class="va">threshold</span><span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">m0</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">m0</span>, <span class="va">s1</span> <span class="op">~</span> <span class="va">y1</span>, <span class="fu">cens1</span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="st">'left'</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">s2</span> <span class="op">~</span> <span class="va">y2</span>, <span class="fu">cens1</span><span class="op">(</span><span class="fl">2</span>,  <span class="st">'right'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim.default.html">sim</a></span><span class="op">(</span><span class="va">m0</span>, <span class="fl">500</span>, p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>r<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span>, seed<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="co">#&gt;           y1         y2           x          s1         s2</span></span>
<span><span class="co">#&gt; 1  0.6452154  0.8677628  1.13496509   0.6452154  0.8677628</span></span>
<span><span class="co">#&gt; 2  1.1098723  0.9579211  1.11193185   1.1098723  0.9579211</span></span>
<span><span class="co">#&gt; 3 -2.2072258 -2.3171509 -0.87077763 -2.0000000- -2.3171509</span></span>
<span><span class="co">#&gt; 4  1.5684365  1.0675354  0.21073159   1.5684365  1.0675354</span></span>
<span><span class="co">#&gt; 5  0.8752209  1.0845932  0.06939565   0.8752209  1.0845932</span></span>
<span><span class="co">#&gt; 6 -1.5113072 -0.7477956 -1.66264885  -1.5113072 -0.7477956</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimation-and-inference">Estimation and inference<a class="anchor" aria-label="anchor" href="#estimation-and-inference"></a>
</h2>
<p>The Maximum Likelihood Estimate can be obtainted using the
<code>estimate</code> method:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lvm.html">lvm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu"><a href="../reference/regression-set.html">regression</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">+</span> <span class="va">y2</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu"><a href="../reference/covariance.html">covariance</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">y2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">m</span>, data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="va">e</span></span>
<span><span class="co">#&gt;                     Estimate Std. Error  Z-value  P-value</span></span>
<span><span class="co">#&gt; Regressions:                                             </span></span>
<span><span class="co">#&gt;    y1~x              0.93300    0.04443 20.99871   &lt;1e-12</span></span>
<span><span class="co">#&gt;     y2~x             0.91652    0.04527 20.24500   &lt;1e-12</span></span>
<span><span class="co">#&gt; Intercepts:                                              </span></span>
<span><span class="co">#&gt;    y1               -0.00541    0.04482 -0.12076   0.9039</span></span>
<span><span class="co">#&gt;    y2               -0.02715    0.04566 -0.59457   0.5521</span></span>
<span><span class="co">#&gt; Residual Variances:                                      </span></span>
<span><span class="co">#&gt;    y1                1.00419    0.06351 15.81139         </span></span>
<span><span class="co">#&gt;    y1~~y2            0.91221    0.06130 14.88041   &lt;1e-12</span></span>
<span><span class="co">#&gt;    y2                1.04252    0.06593 15.81139</span></span></code></pre></div>
<p>The estimate <code>y1~~y2</code> gives us the estimated covariance
between the residual terms in the model. To estimate the correlation we
can apply the delta method using the <code>estimate</code> method
again</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">e</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="va">p</span><span class="op">[</span><span class="st">'y1~~y2'</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="st">'y1~~y1'</span><span class="op">]</span><span class="op">*</span><span class="va">p</span><span class="op">[</span><span class="st">'y2~~y2'</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">.5</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Estimate  Std.Err   2.5%  97.5% P-value</span></span>
<span><span class="co">#&gt; y1~~y2   0.8915 0.008703 0.8745 0.9086       0</span></span></code></pre></div>
<p>Alternatively, the correlations can be extracted using the
<code>correlation</code> method</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/correlation.html">correlation</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Estimate Std.Err   2.5%  97.5%   P-value</span></span>
<span><span class="co">#&gt; y1~y2   0.8915         0.8721 0.9082 3.58e-224</span></span></code></pre></div>
<p>Note, that in this case the confidence intervals are constructed by
using a variance stabilizing transformation, Fishers
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>-transform
<span class="citation">(Lehmann and Romano 2023)</span>,</p>
<p><span class="math display">$$z = \arctanh(\widehat{\rho}) =
  \frac{1}{2}\log\left(\frac{1+\widehat{\rho}}{1-\widehat{\rho}}\right)$$</span>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ρ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\widehat{\rho}</annotation></semantics></math>
is the MLE. This estimate has an approximate asymptotic normal
distribution <span class="math inline">$\mathcal{N}(\arctanh(\rho),\frac{1}{n-3})$</span>.
Hence a asymptotic 95% confidence interval is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>z</mi><mo accent="true">̂</mo></mover><mo>±</mo><mfrac><mn>1.96</mn><msqrt><mrow><mi>n</mi><mo>−</mo><mn>3</mn></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\widehat{z} \pm \frac{1.96}{\sqrt{n-3}}</annotation></semantics></math>
and the confidence interval for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ρ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\widehat{\rho}</annotation></semantics></math>
can directly be calculated by the inverse transformation:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ρ</mi><mo accent="true">̂</mo></mover><mo>=</mo><mo>tanh</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mrow><mn>2</mn><mi>z</mi></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><msup><mi>e</mi><mrow><mn>2</mn><mi>z</mi></mrow></msup><mo>+</mo><mn>1</mn></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">\widehat{\rho} = \tanh(z) = \frac{e^{2z}-1}{e^{2z}+1}.</annotation></semantics></math></p>
<p>This is equivalent to the direct calculations using the delta method
(except for the small sample bias correction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>3</mn><annotation encoding="application/x-tex">3</annotation></semantics></math>)
where the estimate and confidence interval are transformed back to the
original scale using the <code>back.transform</code> argument.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">e</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Hyperbolic.html" class="external-link">atanh</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="st">'y1~~y2'</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="st">'y1~~y1'</span><span class="op">]</span><span class="op">*</span><span class="va">p</span><span class="op">[</span><span class="st">'y2~~y2'</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">.5</span><span class="op">)</span>, back.transform<span class="op">=</span><span class="va">tanh</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Estimate Std.Err   2.5%  97.5%    P-value</span></span>
<span><span class="co">#&gt; y1~~y2   0.8915         0.8732 0.9074 7.445e-249</span></span></code></pre></div>
<p>The transformed confidence interval will generally have improved
coverage especially near the boundary
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>≈</mo><mo>±</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\rho \approx \pm 1</annotation></semantics></math>.</p>
<p>While the estimates of this particular model can be obtained in
closed form, this is generally not the case when for example considering
parameter constraints, latent variables, or missing and censored
observations. The MLE is therefore obtained using iterative optimization
procedures (typically Fisher scoring or Newton-Raphson methods). To
ensure that the estimated variance parameters leads to a meaningful
positive definite structure and to avoid potential problems with
convergence it can often be a good idea to parametrize the model in a
way that such parameter constraints are naturally fulfilled. This can be
achieved with the <code>constrain</code> method.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="va">m</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/internal.html">parameter</a></span><span class="op">(</span><span class="op">~</span> <span class="va">l1</span> <span class="op">+</span> <span class="va">l2</span> <span class="op">+</span> <span class="va">z</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/covariance.html">variance</a></span><span class="op">(</span><span class="op">~</span> <span class="va">y1</span> <span class="op">+</span> <span class="va">y2</span>, value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'v1'</span>,<span class="st">'v2'</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/covariance.html">covariance</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">y2</span>, value<span class="op">=</span><span class="st">'c'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/constrain-set.html">constrain</a></span><span class="op">(</span><span class="va">v1</span> <span class="op">~</span> <span class="va">l1</span>, fun<span class="op">=</span><span class="va">exp</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/constrain-set.html">constrain</a></span><span class="op">(</span><span class="va">v2</span> <span class="op">~</span> <span class="va">l2</span>, fun<span class="op">=</span><span class="va">exp</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/constrain-set.html">constrain</a></span><span class="op">(</span><span class="va">c</span> <span class="op">~</span> <span class="va">z</span><span class="op">+</span><span class="va">l1</span><span class="op">+</span><span class="va">l2</span>, fun<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Hyperbolic.html" class="external-link">tanh</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>In the above code, we first add new parameters <code>l1</code> and
<code>l2</code> to hold the log-variance parameters, and <code>z</code>
which will be the z-transform of the correlation parameter. Next we
label the variances and covariances: The variance of <code>y1</code> is
called <code>v1</code>; the variance of <code>y2</code> is called
<code>v2</code>; the covariance of <code>y1</code> and <code>y2</code>
is called <code>c</code>. Finally, these parameters are tied to the
previously defined parameters using the <code>constrain</code> method
such that <code>v1</code> :=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝚕</mi><mn>𝟷</mn></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\exp(\mathtt{l1})</annotation></semantics></math><code>v2</code> :=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝚕</mi><mn>𝟷</mn></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\exp(\mathtt{l1})</annotation></semantics></math>
and <code>z</code> :=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>tanh</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝚣</mi><mo stretchy="true" form="postfix">)</mo></mrow><msqrt><mrow><mrow><mi>𝚟</mi><mn>𝟷</mn></mrow><mrow><mi>𝚟</mi><mn>𝟸</mn></mrow></mrow></msqrt></mrow><annotation encoding="application/x-tex">\tanh(\mathtt{z})\sqrt{\mathtt{v1}\mathtt{v2}}</annotation></semantics></math>.
In this way there is no constraints on the actual estimated parameters
<code>l1</code>, <code>l2</code>, and <code>z</code> which can take any
values in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ℝ</mi><mn>3</mn></msup><annotation encoding="application/x-tex">\mathbb{R}^{3}</annotation></semantics></math>,
while we at the same time are guaranteed a proper covariance matrix
which is positive definite.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">m2</span>, <span class="va">d</span><span class="op">)</span></span>
<span><span class="va">e2</span></span>
<span><span class="co">#&gt;                        Estimate Std. Error  Z-value  P-value</span></span>
<span><span class="co">#&gt; Regressions:                                                </span></span>
<span><span class="co">#&gt;    y1~x                 0.93300    0.04443 20.99871   &lt;1e-12</span></span>
<span><span class="co">#&gt;     y2~x                0.91652    0.04527 20.24500   &lt;1e-12</span></span>
<span><span class="co">#&gt; Intercepts:                                                 </span></span>
<span><span class="co">#&gt;    y1                  -0.00541    0.04482 -0.12076   0.9039</span></span>
<span><span class="co">#&gt;    y2                  -0.02715    0.04566 -0.59457   0.5521</span></span>
<span><span class="co">#&gt; Additional Parameters:                                      </span></span>
<span><span class="co">#&gt;    l1                   0.00418    0.06325  0.06617   0.9472</span></span>
<span><span class="co">#&gt;    l2                   0.04164    0.06325  0.65832   0.5103</span></span>
<span><span class="co">#&gt;    z                    1.42942    0.04472 31.96286   &lt;1e-12</span></span></code></pre></div>
<p>The correlation coefficient can then be obtained as</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">e2</span>, <span class="st">'z'</span>, back.transform<span class="op">=</span><span class="va">tanh</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Estimate Std.Err   2.5%  97.5%    P-value</span></span>
<span><span class="co">#&gt; [z]   0.8915         0.8729 0.9076 5.606e-243</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Null Hypothesis: </span></span>
<span><span class="co">#&gt;   [z] = 0</span></span></code></pre></div>
<p>In practice, a much shorter syntax can be used to obtain the above
parametrization. We can simply use the argument <code>constrain</code>
when specifying the covariances (the argument <code>rname</code>
specifies the parameter name of the <span class="math inline">$\arctanh$</span> transformed correlation
coefficient, and <code>lname</code>, <code>lname2</code> can be used to
specify the parameter names for the log variance parameters):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lvm.html">lvm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/regression-set.html">regression</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">+</span> <span class="va">y2</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/covariance.html">covariance</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">y2</span>, constrain<span class="op">=</span><span class="cn">TRUE</span>, rname<span class="op">=</span><span class="st">'z'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">e2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">m2</span>, data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="va">e2</span></span>
<span><span class="co">#&gt;                        Estimate Std. Error  Z-value  P-value</span></span>
<span><span class="co">#&gt; Regressions:                                                </span></span>
<span><span class="co">#&gt;    y1~x                 0.93300    0.04443 20.99871   &lt;1e-12</span></span>
<span><span class="co">#&gt;     y2~x                0.91652    0.04527 20.24500   &lt;1e-12</span></span>
<span><span class="co">#&gt; Intercepts:                                                 </span></span>
<span><span class="co">#&gt;    y1                  -0.00541    0.04482 -0.12076   0.9039</span></span>
<span><span class="co">#&gt;    y2                  -0.02715    0.04566 -0.59457   0.5521</span></span>
<span><span class="co">#&gt; Additional Parameters:                                      </span></span>
<span><span class="co">#&gt;    l1                   0.00418    0.06325  0.06617   0.9472</span></span>
<span><span class="co">#&gt;    l2                   0.04164    0.06325  0.65832   0.5103</span></span>
<span><span class="co">#&gt;    z                    1.42942    0.04472 31.96286   &lt;1e-12</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">e2</span>, <span class="st">'z'</span>, back.transform<span class="op">=</span><span class="va">tanh</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Estimate Std.Err   2.5%  97.5%    P-value</span></span>
<span><span class="co">#&gt; [z]   0.8915         0.8729 0.9076 5.606e-243</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Null Hypothesis: </span></span>
<span><span class="co">#&gt;   [z] = 0</span></span></code></pre></div>
<p>As an alternative to the Wald confidence intervals (with or without
transformation) is to profile the likelihood. The profile likelihood
confidence intervals can be obtained with the <code>confint</code>
method:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Hyperbolic.html" class="external-link">tanh</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">e2</span>, <span class="st">'z'</span>, profile<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       2.5 %    97.5 %</span></span>
<span><span class="co">#&gt; z 0.8720834 0.9081964</span></span></code></pre></div>
<p>Finally, a non-parametric bootstrap (in practice a larger number of
replications would be needed) can be calculated in the following way</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootstrap.html">bootstrap</a></span><span class="op">(</span><span class="va">e2</span>, data<span class="op">=</span><span class="va">d</span>, R<span class="op">=</span><span class="fl">50</span>, mc.cores<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">b</span></span>
<span><span class="co">#&gt; Non-parametric bootstrap statistics (R=50):</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      Estimate      Bias          Std.Err       2.5 %         97.5 %       </span></span>
<span><span class="co">#&gt; y1   -0.0054119135 -0.0009992035  0.0467447038 -0.0932389998  0.0770206657</span></span>
<span><span class="co">#&gt; y2   -0.0271494916  0.0002650151  0.0467360144 -0.1211337493  0.0483704809</span></span>
<span><span class="co">#&gt; y1~x  0.9330043509 -0.0149098946  0.0515360969  0.8309736543  0.9998117487</span></span>
<span><span class="co">#&gt; y2~x  0.9165185250 -0.0054613366  0.0515815249  0.8206914258  1.0057939308</span></span>
<span><span class="co">#&gt; l1    0.0041846522 -0.0207541703  0.0680010956 -0.1521461170  0.0970349017</span></span>
<span><span class="co">#&gt; l2    0.0416361064 -0.0172477586  0.0645290353 -0.1102270167  0.1486146877</span></span>
<span><span class="co">#&gt; z     1.4294227075 -0.0086990026  0.0431164145  1.3409919820  1.4973573361</span></span>
<span><span class="co">#&gt; v1    1.0041934200 -0.0184096665  0.0664333005  0.8588861834  1.1019310023</span></span>
<span><span class="co">#&gt; v2    1.0425150452 -0.0157357318  0.0662409478  0.8956329451  1.1602357905</span></span>
<span><span class="co">#&gt; c1    0.9122097189 -0.0171972066  0.0627102019  0.7706302260  1.0085879892</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Hyperbolic.html" class="external-link">tanh</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span>,<span class="st">'z'</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.025</span>,<span class="fl">.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      2.5%     97.5% </span></span>
<span><span class="co">#&gt; 0.8719025 0.9046521</span></span></code></pre></div>
<div class="section level3">
<h3 id="censored-observations">Censored observations<a class="anchor" aria-label="anchor" href="#censored-observations"></a>
</h3>
<p>Letting one of the variables be right-censored (Tobit-type model) we
can proceed in exactly the same way (note, this functionality is only
available with the <code>mets</code> package installed - available from
CRAN). The only difference is that the variables that are censored must
all be defined as <code>Surv</code> objects (from the
<code>survival</code> package which is automatically loaded when using
the <code>mets</code> package) in the data frame.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lvm.html">lvm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/regression-set.html">regression</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">+</span> <span class="va">s2</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/covariance.html">covariance</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">s2</span>, constrain<span class="op">=</span><span class="cn">TRUE</span>, rname<span class="op">=</span><span class="st">'z'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">e3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">m3</span>, <span class="va">d</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e3</span></span>
<span><span class="co">#&gt;                        Estimate Std. Error  Z-value  P-value</span></span>
<span><span class="co">#&gt; Regressions:                                                </span></span>
<span><span class="co">#&gt;    y1~x                 0.93301    0.04443 20.99891   &lt;1e-12</span></span>
<span><span class="co">#&gt;     s2~x                0.92402    0.04643 19.90128   &lt;1e-12</span></span>
<span><span class="co">#&gt; Intercepts:                                                 </span></span>
<span><span class="co">#&gt;    y1                  -0.00542    0.04482 -0.12083   0.9038</span></span>
<span><span class="co">#&gt;    s2                  -0.02119    0.04638 -0.45687   0.6478</span></span>
<span><span class="co">#&gt; Additional Parameters:                                      </span></span>
<span><span class="co">#&gt;    l1                   0.00418    0.06325  0.06607   0.9473</span></span>
<span><span class="co">#&gt;    l2                   0.06317    0.06492  0.97307   0.3305</span></span>
<span><span class="co">#&gt;    z                    1.42835    0.04546 31.41861   &lt;1e-12</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">e3</span>, <span class="st">'z'</span>, back.transform<span class="op">=</span><span class="va">tanh</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Estimate Std.Err  2.5%  97.5%    P-value</span></span>
<span><span class="co">#&gt; [z]   0.8913         0.872 0.9079 1.491e-226</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Null Hypothesis: </span></span>
<span><span class="co">#&gt;   [z] = 0</span></span></code></pre></div>
<p>And here the same analysis with <code>s1</code> being left-censored
and <code>s2</code> right-censored:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lvm.html">lvm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/regression-set.html">regression</a></span><span class="op">(</span><span class="va">s1</span> <span class="op">+</span> <span class="va">s2</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/covariance.html">covariance</a></span><span class="op">(</span><span class="va">s1</span> <span class="op">~</span> <span class="va">s2</span>, constrain<span class="op">=</span><span class="cn">TRUE</span>, rname<span class="op">=</span><span class="st">'z'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">e3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">m3b</span>, <span class="va">d</span><span class="op">)</span></span>
<span><span class="va">e3b</span></span>
<span><span class="co">#&gt;                        Estimate Std. Error  Z-value  P-value</span></span>
<span><span class="co">#&gt; Regressions:                                                </span></span>
<span><span class="co">#&gt;    s1~x                 0.92834    0.04479 20.72734   &lt;1e-12</span></span>
<span><span class="co">#&gt;     s2~x                0.92466    0.04648 19.89515   &lt;1e-12</span></span>
<span><span class="co">#&gt; Intercepts:                                                 </span></span>
<span><span class="co">#&gt;    s1                  -0.00233    0.04492 -0.05185   0.9586</span></span>
<span><span class="co">#&gt;    s2                  -0.02083    0.04641 -0.44874   0.6536</span></span>
<span><span class="co">#&gt; Additional Parameters:                                      </span></span>
<span><span class="co">#&gt;    l1                  -0.00075    0.06500 -0.01156   0.9908</span></span>
<span><span class="co">#&gt;    l2                   0.06425    0.06498  0.98869   0.3228</span></span>
<span><span class="co">#&gt;    z                    1.42627    0.04609 30.94282   &lt;1e-12</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e3b</span></span>
<span><span class="co">#&gt;                        Estimate Std. Error  Z-value  P-value</span></span>
<span><span class="co">#&gt; Regressions:                                                </span></span>
<span><span class="co">#&gt;    s1~x                 0.92834    0.04479 20.72734   &lt;1e-12</span></span>
<span><span class="co">#&gt;     s2~x                0.92466    0.04648 19.89515   &lt;1e-12</span></span>
<span><span class="co">#&gt; Intercepts:                                                 </span></span>
<span><span class="co">#&gt;    s1                  -0.00233    0.04492 -0.05185   0.9586</span></span>
<span><span class="co">#&gt;    s2                  -0.02083    0.04641 -0.44874   0.6536</span></span>
<span><span class="co">#&gt; Additional Parameters:                                      </span></span>
<span><span class="co">#&gt;    l1                  -0.00075    0.06500 -0.01156   0.9908</span></span>
<span><span class="co">#&gt;    l2                   0.06425    0.06498  0.98869   0.3228</span></span>
<span><span class="co">#&gt;    z                    1.42627    0.04609 30.94282   &lt;1e-12</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate.default.html">estimate</a></span><span class="op">(</span><span class="va">e3b</span>, <span class="st">'z'</span>, back.transform<span class="op">=</span><span class="va">tanh</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Estimate Std.Err   2.5%  97.5%    P-value</span></span>
<span><span class="co">#&gt; [z]   0.8909         0.8713 0.9077 9.006e-222</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Null Hypothesis: </span></span>
<span><span class="co">#&gt;   [z] = 0</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Hyperbolic.html" class="external-link">tanh</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">e3b</span>, <span class="st">'z'</span>, profile<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       2.5 %    97.5 %</span></span>
<span><span class="co">#&gt; z 0.8706426 0.9080912</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="sessioninfo">SessionInfo<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] lava_1.8.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] Matrix_1.7-3        future.apply_1.20.0 jsonlite_2.0.0     </span></span>
<span><span class="co">#&gt;  [4] compiler_4.5.1      Rcpp_1.1.0          parallel_4.5.1     </span></span>
<span><span class="co">#&gt;  [7] Rgraphviz_2.52.0    jquerylib_0.1.4     globals_0.18.0     </span></span>
<span><span class="co">#&gt; [10] splines_4.5.1       systemfonts_1.3.1   textshaping_1.0.4  </span></span>
<span><span class="co">#&gt; [13] yaml_2.3.10         fastmap_1.2.0       lattice_0.22-7     </span></span>
<span><span class="co">#&gt; [16] R6_2.6.1            generics_0.1.4      knitr_1.50         </span></span>
<span><span class="co">#&gt; [19] BiocGenerics_0.54.1 htmlwidgets_1.6.4   graph_1.86.0       </span></span>
<span><span class="co">#&gt; [22] future_1.67.0       desc_1.4.3          bslib_0.9.0        </span></span>
<span><span class="co">#&gt; [25] rlang_1.1.6         cachem_1.1.0        xfun_0.53          </span></span>
<span><span class="co">#&gt; [28] fs_1.6.6            sass_0.4.10         cli_3.6.5          </span></span>
<span><span class="co">#&gt; [31] progressr_0.17.0    pkgdown_2.1.3       digest_0.6.37      </span></span>
<span><span class="co">#&gt; [34] grid_4.5.1          mvtnorm_1.3-3       lifecycle_1.0.4    </span></span>
<span><span class="co">#&gt; [37] timereg_2.0.7       evaluate_1.0.5      numDeriv_2016.8-1.1</span></span>
<span><span class="co">#&gt; [40] listenv_0.9.1       codetools_0.2-20    ragg_1.5.0         </span></span>
<span><span class="co">#&gt; [43] survival_3.8-3      stats4_4.5.1        parallelly_1.45.1  </span></span>
<span><span class="co">#&gt; [46] rmarkdown_2.30      mets_1.3.8          tools_4.5.1        </span></span>
<span><span class="co">#&gt; [49] htmltools_0.5.8.1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-lehmann2023_testing" class="csl-entry">
Lehmann, E. L., and Joseph P. Romano. 2023. <em>Testing Statistical
Hypotheses</em>. Fourth. Springer Texts in Statistics. New York:
Springer. <a href="https://doi.org/10.1007/978-3-030-70578-7" class="external-link">https://doi.org/10.1007/978-3-030-70578-7</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Klaus K. Holst.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
