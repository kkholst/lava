<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimation of functional of parameters — estimate.default • lava</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimation of functional of parameters — estimate.default"><meta name="description" content="Estimation of functional of parameters. Wald tests, robust standard errors,
cluster robust standard errors, LRT (when f is not a function)..."><meta property="og:description" content="Estimation of functional of parameters. Wald tests, robust standard errors,
cluster robust standard errors, LRT (when f is not a function)..."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lava</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/correlation.html">Estimating partial correlations with lava</a></li>
    <li><a class="dropdown-item" href="../articles/influencefunction.html">The Art of Influence</a></li>
    <li><a class="dropdown-item" href="../articles/nonlinear.html">Non-linear latent variable models and error-in-variable models</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kkholst/lava/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimation of functional of parameters</h1>
      <small class="dont-index">Source: <a href="https://github.com/kkholst/lava/blob/main/R/estimate.default.R" class="external-link"><code>R/estimate.default.R</code></a></small>
      <div class="d-none name"><code>estimate.default.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimation of functional of parameters. Wald tests, robust standard errors,
cluster robust standard errors, LRT (when <code>f</code> is not a function)...</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Default S3 method</span></span>
<span><span class="fu">estimate</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  f <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">id</span>,</span>
<span>  <span class="va">iddata</span>,</span>
<span>  stack <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  average <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">subset</span>,</span>
<span>  <span class="va">score.deriv</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  IC <span class="op">=</span> <span class="va">robust</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"robust"</span>, <span class="st">"df"</span>, <span class="st">"mbn"</span><span class="op">)</span>,</span>
<span>  <span class="va">keep</span>,</span>
<span>  <span class="va">use</span>,</span>
<span>  regex <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ignore.case <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">contrast</span>,</span>
<span>  <span class="va">null</span>,</span>
<span>  <span class="va">vcov</span>,</span>
<span>  <span class="va">coef</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  print <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">labels</span>,</span>
<span>  <span class="va">label.width</span>,</span>
<span>  only.coef <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  back.transform <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  folds <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">cluster</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">null.sim</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>model object (<code>glm</code>, <code>lvmfit</code>, ...)</p></dd>


<dt id="arg-f">f<a class="anchor" aria-label="anchor" href="#arg-f"></a></dt>
<dd><p>transformation of model parameters and (optionally) data, or
contrast matrix (or vector)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments to lower level functions</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><code>data.frame</code></p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>(optional) id-variable corresponding to ic decomposition of model
parameters.</p></dd>


<dt id="arg-iddata">iddata<a class="anchor" aria-label="anchor" href="#arg-iddata"></a></dt>
<dd><p>(optional) id-variable for 'data'</p></dd>


<dt id="arg-stack">stack<a class="anchor" aria-label="anchor" href="#arg-stack"></a></dt>
<dd><p>if TRUE (default) the i.i.d. decomposition is automatically
stacked according to 'id'</p></dd>


<dt id="arg-average">average<a class="anchor" aria-label="anchor" href="#arg-average"></a></dt>
<dd><p>if TRUE averages are calculated</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>(optional) subset of data.frame on which to condition (logical
expression or variable name)</p></dd>


<dt id="arg-score-deriv">score.deriv<a class="anchor" aria-label="anchor" href="#arg-score-deriv"></a></dt>
<dd><p>(optional) derivative of mean score function</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>level of confidence limits</p></dd>


<dt id="arg-ic">IC<a class="anchor" aria-label="anchor" href="#arg-ic"></a></dt>
<dd><p>if TRUE (default) the influence function decompositions are also
returned (extract with <code>IC</code> method)</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>type of small-sample correction</p></dd>


<dt id="arg-keep">keep<a class="anchor" aria-label="anchor" href="#arg-keep"></a></dt>
<dd><p>(optional) index of parameters to keep from final result</p></dd>


<dt id="arg-use">use<a class="anchor" aria-label="anchor" href="#arg-use"></a></dt>
<dd><p>(optional) index of parameters to use in calculations</p></dd>


<dt id="arg-regex">regex<a class="anchor" aria-label="anchor" href="#arg-regex"></a></dt>
<dd><p>If TRUE use regular expression (perl compatible) for keep, use
arguments</p></dd>


<dt id="arg-ignore-case">ignore.case<a class="anchor" aria-label="anchor" href="#arg-ignore-case"></a></dt>
<dd><p>Ignore case-sensitiveness in regular expression</p></dd>


<dt id="arg-contrast">contrast<a class="anchor" aria-label="anchor" href="#arg-contrast"></a></dt>
<dd><p>(optional) Contrast matrix for final Wald test</p></dd>


<dt id="arg-null">null<a class="anchor" aria-label="anchor" href="#arg-null"></a></dt>
<dd><p>(optional) null hypothesis to test</p></dd>


<dt id="arg-vcov">vcov<a class="anchor" aria-label="anchor" href="#arg-vcov"></a></dt>
<dd><p>(optional) covariance matrix of parameter estimates (e.g.
Wald-test)</p></dd>


<dt id="arg-coef">coef<a class="anchor" aria-label="anchor" href="#arg-coef"></a></dt>
<dd><p>(optional) parameter coefficient</p></dd>


<dt id="arg-robust">robust<a class="anchor" aria-label="anchor" href="#arg-robust"></a></dt>
<dd><p>if TRUE robust standard errors are calculated. If FALSE
p-values for linear models are calculated from t-distribution</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>degrees of freedom (default obtained from 'df.residual')</p></dd>


<dt id="arg-print">print<a class="anchor" aria-label="anchor" href="#arg-print"></a></dt>
<dd><p>(optional) print function</p></dd>


<dt id="arg-labels">labels<a class="anchor" aria-label="anchor" href="#arg-labels"></a></dt>
<dd><p>(optional) names of coefficients</p></dd>


<dt id="arg-label-width">label.width<a class="anchor" aria-label="anchor" href="#arg-label-width"></a></dt>
<dd><p>(optional) max width of labels</p></dd>


<dt id="arg-only-coef">only.coef<a class="anchor" aria-label="anchor" href="#arg-only-coef"></a></dt>
<dd><p>if TRUE only the coefficient matrix is return</p></dd>


<dt id="arg-back-transform">back.transform<a class="anchor" aria-label="anchor" href="#arg-back-transform"></a></dt>
<dd><p>(optional) transform of parameters and confidence
intervals</p></dd>


<dt id="arg-folds">folds<a class="anchor" aria-label="anchor" href="#arg-folds"></a></dt>
<dd><p>(optional) aggregate influence functions (divide and conquer)</p></dd>


<dt id="arg-cluster">cluster<a class="anchor" aria-label="anchor" href="#arg-cluster"></a></dt>
<dd><p>(obsolete) alias for 'id'.</p></dd>


<dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>Number of simulations (simulated p-values)</p></dd>


<dt id="arg-null-sim">null.sim<a class="anchor" aria-label="anchor" href="#arg-null-sim"></a></dt>
<dd><p>Mean under the null for simulations</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>influence function decomposition of estimator \(\widehat{\theta}\) based
on data \(Z_1,\ldots,Z_n\): $$\sqrt{n}(\widehat{\theta}-\theta) =
\frac{1}{\sqrt{n}}\sum_{i=1}^n IC(Z_i; P) + o_p(1)$$ can be extracted with
the <code>IC</code> method.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>estimate.array</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Simulation from logistic regression model</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="lvm.html">lvm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">z</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="fu"><a href="sim.html">distribution</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim.html">binomial.lvm</a></span><span class="op">(</span><span class="st">"logit"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim.html">sim</a></span><span class="op">(</span><span class="va">m</span>,<span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">z</span><span class="op">+</span><span class="va">x</span>,data<span class="op">=</span><span class="va">d</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">d</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## LRT</span></span></span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,<span class="va">g0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	- Likelihood ratio test -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> chisq = 214.1, df = 2, p-value &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log likelihood (model 1) log likelihood (model 2) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                -570.8831                -677.9319 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plain estimates (robust standard errors)</span></span></span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std.Err    2.5%  97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.07117 0.09911 -0.2654 0.1231 4.727e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z            0.95923 0.08326  0.7960 1.1224 1.037e-30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x            1.01347 0.14415  0.7309 1.2960 2.055e-12</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Testing contrasts</span></span></span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,null<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Std.Err    2.5%  97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [(Intercept)] -0.07117 0.09911 -0.2654 0.1231 4.727e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [z]            0.95923 0.08326  0.7960 1.1224 1.037e-30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [x]            1.01347 0.14415  0.7309 1.2960 2.055e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Null Hypothesis: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [(Intercept)] = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [z] = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [x] = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> chisq = 191.8908, df = 3, p-value &lt; 2.2e-16</span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,<span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Estimate Std.Err   2.5% 97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [(Intercept)] + [z]    0.8881  0.1297 0.6339 1.142 7.471e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [(Intercept)] + 2[x]   1.9558  0.2318 1.5015 2.410 3.202e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Null Hypothesis: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [(Intercept)] + [z] = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [(Intercept)] + 2[x] = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> chisq = 158.1963, df = 2, p-value &lt; 2.2e-16</span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,<span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,null<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Estimate Std.Err   2.5% 97.5% P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [(Intercept)] + [z]    0.8881  0.1297 0.6339 1.142  0.3880</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [(Intercept)] + 2[x]   1.9558  0.2318 1.5015 2.410  0.8486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Null Hypothesis: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [(Intercept)] + [z] = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [(Intercept)] + 2[x] = 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> chisq = 0.9273, df = 2, p-value = 0.629</span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="co">## same as cbind(0,1,-1)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate Std.Err    2.5%  97.5% P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [z] - [x] -0.05424  0.1602 -0.3682 0.2597  0.7349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Null Hypothesis: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [z] - [x] = 0 </span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="co">## same as rbind(c(0,1,0),c(0,0,1))</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Estimate Std.Err   2.5% 97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [z]   0.9592 0.08326 0.7960 1.122 1.037e-30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [x]   1.0135 0.14415 0.7309 1.296 2.055e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Null Hypothesis: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [z] = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [x] = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> chisq = 169.5678, df = 2, p-value &lt; 2.2e-16</span>
<span class="r-in"><span><span class="co">## Alternative syntax</span></span></span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,<span class="st">"z"</span>,<span class="st">"z"</span><span class="op">-</span><span class="st">"x"</span>,<span class="fl">2</span><span class="op">*</span><span class="st">"z"</span><span class="op">-</span><span class="fl">3</span><span class="op">*</span><span class="st">"x"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std.Err    2.5%   97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [z]          0.95923 0.08326  0.7960  1.1224 1.037e-30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [z] - [x]   -0.05424 0.16020 -0.3682  0.2597 7.349e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[z] - 3[x] -1.12195 0.44994 -2.0038 -0.2401 1.265e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Null Hypothesis: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [z] = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [z] - [x] = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2[z] - 3[x] = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> chisq = 169.5678, df = 2, p-value &lt; 2.2e-16</span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,<span class="st">"?"</span><span class="op">)</span>  <span class="co">## Wildcards</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate Std.Err    2.5%  97.5% P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [z] - [x] -0.05424  0.1602 -0.3682 0.2597  0.7349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Null Hypothesis: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [z] - [x] = 0 </span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,<span class="st">"*Int*"</span>,<span class="st">"z"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Std.Err    2.5%  97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [(Intercept)] -0.07117 0.09911 -0.2654 0.1231 4.727e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [z]            0.95923 0.08326  0.7960 1.1224 1.037e-30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Null Hypothesis: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [(Intercept)] = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [z] = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> chisq = 133.3069, df = 2, p-value &lt; 2.2e-16</span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,<span class="st">"1"</span>,<span class="st">"2"</span><span class="op">-</span><span class="st">"3"</span>,null<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Std.Err    2.5%  97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [(Intercept)] -0.07117 0.09911 -0.2654 0.1231 4.727e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [z] - [x]     -0.05424 0.16020 -0.3682 0.2597 4.674e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Null Hypothesis: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [(Intercept)] = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [z] - [x] = 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> chisq = 61.6299, df = 2, p-value = 4.142e-14</span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Estimate Std.Err   2.5% 97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [z]   0.9592 0.08326 0.7960 1.122 1.037e-30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [x]   1.0135 0.14415 0.7309 1.296 2.055e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Null Hypothesis: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [z] = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [x] = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> chisq = 169.5678, df = 2, p-value &lt; 2.2e-16</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Usual (non-robust) confidence intervals</span></span></span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,robust<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std.Err    2.5%  97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.07117 0.09814 -0.2635 0.1212 4.683e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z            0.95923 0.08316  0.7962 1.1222 8.788e-31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x            1.01347 0.14564  0.7280 1.2989 3.432e-12</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Transformations</span></span></span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,<span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std.Err   2.5% 97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   0.8881  0.1297 0.6339 1.142 7.471e-12</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Multiple parameters</span></span></span>
<span class="r-in"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,<span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">e</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Std.Err    2.5%  97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    0.88806 0.12967  0.6339 1.1422 7.471e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept).1 -0.06827 0.09523 -0.2549 0.1184 4.734e-01</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept) (Intercept)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 0.016815549 0.008955385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 0.008955385 0.009068500</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Label new parameters</span></span></span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,<span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"a1"</span><span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">"b1"</span><span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std.Err    2.5%  97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a1  0.88806 0.12967  0.6339 1.1422 7.471e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b1 -0.06827 0.09523 -0.2549 0.1184 4.734e-01</span>
<span class="r-in"><span><span class="co">##'</span></span></span>
<span class="r-in"><span><span class="co">## Multiple group</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="lvm.html">lvm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="baptize.html">baptize</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim.html">sim</a></span><span class="op">(</span><span class="va">m</span>,<span class="fl">50</span>,seed<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu">estimate</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">m</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">d1</span>,<span class="va">d2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="co">## Wrong</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate Std.Err     2.5%  97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y@1      0.1044 0.08277 -0.05785 0.2666 2.073e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y~x@1    0.9665 0.08727  0.79541 1.1375 1.677e-28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y~~y@1   0.6764 0.10629  0.46803 0.8847 1.977e-10</span>
<span class="r-in"><span><span class="va">ee</span> <span class="op">&lt;-</span> <span class="fu">estimate</span><span class="op">(</span><span class="va">e</span>, id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">## Clustered</span></span></span>
<span class="r-in"><span><span class="va">ee</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate Std.Err    2.5%  97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y@1      0.1044  0.1171 -0.1250 0.3338 3.725e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y~x@1    0.9665  0.1234  0.7246 1.2084 4.859e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y~~y@1   0.6764  0.1503  0.3817 0.9710 6.814e-06</span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>,<span class="va">d1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std.Err    2.5%  97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   0.1044  0.1171 -0.1251 0.3338 3.726e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x             0.9665  0.1234  0.7246 1.2084 4.853e-15</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Marginalize</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>,<span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>p0<span class="op">=</span><span class="fu">lava</span><span class="fu">:::</span><span class="fu"><a href="internal.html">expit</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="st">"(Intercept)"</span><span class="op">]</span> <span class="op">+</span> <span class="va">p</span><span class="op">[</span><span class="st">"z"</span><span class="op">]</span><span class="op">*</span><span class="va">data</span><span class="op">[</span>,<span class="st">"z"</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       p1<span class="op">=</span><span class="fu">lava</span><span class="fu">:::</span><span class="fu"><a href="internal.html">expit</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="st">"(Intercept)"</span><span class="op">]</span> <span class="op">+</span> <span class="va">p</span><span class="op">[</span><span class="st">"x"</span><span class="op">]</span> <span class="op">+</span> <span class="va">p</span><span class="op">[</span><span class="st">"z"</span><span class="op">]</span><span class="op">*</span><span class="va">data</span><span class="op">[</span>,<span class="st">"z"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>, <span class="va">f</span>, average<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">e</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std.Err   2.5%  97.5%    P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p0   0.4860 0.02150 0.4438 0.5281 4.175e-113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p1   0.6884 0.01992 0.6494 0.7275 1.089e-261</span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">e</span>,<span class="va">diff</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std.Err   2.5%  97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p1   0.2024 0.02802 0.1475 0.2573 5.069e-13</span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">e</span>,<span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std.Err  2.5% 97.5%    P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [p0] + [p1]    1.174 0.03055 1.115 1.234 1.976e-323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Null Hypothesis: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [p0] + [p1] = 0 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Clusters and subset (conditional marginal effects)</span></span></span>
<span class="r-in"><span><span class="va">d</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">g</span>,<span class="kw">function</span><span class="op">(</span><span class="va">p</span>,<span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span>         <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>p0<span class="op">=</span><span class="fu">lava</span><span class="fu">:::</span><span class="fu"><a href="internal.html">expit</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">p</span><span class="op">[</span><span class="st">"z"</span><span class="op">]</span><span class="op">*</span><span class="va">data</span><span class="op">[</span>,<span class="st">"z"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         subset<span class="op">=</span><span class="va">d</span><span class="op">$</span><span class="va">z</span><span class="op">&gt;</span><span class="fl">0</span>, id<span class="op">=</span><span class="va">d</span><span class="op">$</span><span class="va">id</span>, average<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std.Err   2.5%  97.5%    P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p0   0.6611 0.02218 0.6176 0.7046 3.296e-195</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## More examples with clusters:</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="lvm.html">lvm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y1</span>,<span class="va">y2</span>,<span class="va">y3</span><span class="op">)</span><span class="op">~</span><span class="va">u</span><span class="op">+</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim.html">sim</a></span><span class="op">(</span><span class="va">m</span>,<span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">l1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y1</span><span class="op">~</span><span class="va">x</span>,data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">l2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y2</span><span class="op">~</span><span class="va">x</span>,data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">l3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y3</span><span class="op">~</span><span class="va">x</span>,data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Some random id-numbers</span></span></span>
<span class="r-in"><span><span class="va">id1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">id2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">id3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Un-stacked and stacked i.i.d. decomposition</span></span></span>
<span class="r-in"><span><span class="fu"><a href="IC.html">IC</a></span><span class="op">(</span><span class="fu">estimate</span><span class="op">(</span><span class="va">l1</span>,id<span class="op">=</span><span class="va">id1</span>,stack<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (Intercept)          x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0.6443282 -1.5615821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0.8292245 -0.3681720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   1.5725072 -0.7053035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  -1.5588173 -1.2129716</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1.5615501  2.9936336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  -1.0524707  7.9231560</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   0.7800032 -2.7353224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  -4.2476305 -4.4726609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  -0.2651809 -0.4020531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   1.7364862  0.5412760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"bread")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)         x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    4.175654  2.360059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x              2.360059 12.463714</span>
<span class="r-in"><span><span class="fu"><a href="IC.html">IC</a></span><span class="op">(</span><span class="fu">estimate</span><span class="op">(</span><span class="va">l1</span>,id<span class="op">=</span><span class="va">id1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (Intercept)          x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  -0.5688677  2.3902152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   0.3900016 -1.3676612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  -1.3430402 -0.7395136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   0.6536632 -0.5536783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   0.8682431  0.2706380</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"bread")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)         x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    4.175654  2.360059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x              2.360059 12.463714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"N")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Combined i.i.d. decomposition</span></span></span>
<span class="r-in"><span><span class="va">e1</span> <span class="op">&lt;-</span> <span class="fu">estimate</span><span class="op">(</span><span class="va">l1</span>,id<span class="op">=</span><span class="va">id1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">e2</span> <span class="op">&lt;-</span> <span class="fu">estimate</span><span class="op">(</span><span class="va">l2</span>,id<span class="op">=</span><span class="va">id2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">e3</span> <span class="op">&lt;-</span> <span class="fu">estimate</span><span class="op">(</span><span class="va">l3</span>,id<span class="op">=</span><span class="va">id3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">a2</span> <span class="op">&lt;-</span> <span class="fu"><a href="internal.html">merge</a></span><span class="op">(</span><span class="va">e1</span>,<span class="va">e2</span>,<span class="va">e3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Std.Err     2.5%  97.5% P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    -0.1858  0.3721 -0.91501 0.5434 0.61751</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x               0.2707  0.5834 -0.87285 1.4142 0.64268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept).1   0.6284  0.3617 -0.08055 1.3373 0.08234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x.1             0.4415  0.7723 -1.07229 1.9552 0.56759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept).2   0.5316  0.3364 -0.12786 1.1910 0.11412</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x.2             1.0678  0.5171  0.05420 2.0813 0.03894</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## If all models were estimated on the same data we could use the</span></span></span>
<span class="r-in"><span><span class="co">## syntax:</span></span></span>
<span class="r-in"><span><span class="co">## Reduce(merge,estimate(list(l1,l2,l3)))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Same:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="IC.html">IC</a></span><span class="op">(</span><span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu"><a href="internal.html">merge</a></span><span class="op">(</span><span class="va">l1</span>,<span class="va">l2</span>,<span class="va">l3</span>,id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">id1</span>,<span class="va">id2</span>,<span class="va">id3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    (Intercept)         x (Intercept).1        x.1 (Intercept).2        x.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   -1.1377353  4.780430    -0.0683124 -2.9519582   -0.87137910  2.1118587</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    0.7800032 -2.735322     1.7168997  0.5351707   -0.43814610  0.1945349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   -2.6860804 -1.479027     0.4120817 -0.1829625    1.36962838 -0.6143080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    1.3073264 -1.107357     1.9069664 -0.8553157   -0.28910871 -0.2249658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    1.7364862  0.541276    -1.6893508 -1.3145444   -0.20205165 -0.3873514</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    0.0000000  0.000000    -1.2666254 -2.4282362   -0.06001604  0.4518097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    0.0000000  0.000000    -0.9076952  6.8332644    0.87312198 -3.0618723</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    0.0000000  0.000000    -0.1039640  0.3645818   -1.21352121 -1.2778110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    0.0000000  0.000000     0.0000000  0.0000000    2.11627845  3.2085890</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   0.0000000  0.000000     0.0000000  0.0000000   -1.28480599 -0.4004838</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="IC.html">IC</a></span><span class="op">(</span><span class="fu"><a href="internal.html">merge</a></span><span class="op">(</span><span class="va">l1</span>,<span class="va">l2</span>,<span class="va">l3</span>,id<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co"># one-to-one (same clusters)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    (Intercept)          x (Intercept).1        x.1 (Intercept).2        x.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    0.6443282 -1.5615821     0.7607628 -1.8437710   -0.87137910  2.1118587</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    0.8292245 -0.3681720     1.7168997  0.5351707   -0.43814610  0.1945349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    1.5725072 -0.7053035     0.4120817 -0.1829625    1.36962838 -0.6143080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   -1.5588173 -1.2129716     1.9069664 -0.8553157   -0.28910871 -0.2249658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    1.5615501  2.9936336    -1.6893508 -1.3145444   -0.20205165 -0.3873514</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   -1.0524707  7.9231560    -1.2666254 -2.4282362   -0.06001604  0.4518097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    0.7800032 -2.7353224    -0.9076952  6.8332644    0.87312198 -3.0618723</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   -4.2476305 -4.4726609    -0.1039640  0.3645818   -1.21352121 -1.2778110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   -0.2651809 -0.4020531    -0.3212921 -0.3383135    2.11627845  3.2085890</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   1.7364862  0.5412760    -0.5077830 -0.7698737   -1.28480599 -0.4004838</span>
<span class="r-in"><span><span class="fu"><a href="IC.html">IC</a></span><span class="op">(</span><span class="fu"><a href="internal.html">merge</a></span><span class="op">(</span><span class="va">l1</span>,<span class="va">l2</span>,<span class="va">l3</span>,id<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="co"># independence</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    (Intercept)          x (Intercept).1        x.1 (Intercept).2        x.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1.9329845  -4.684746     0.0000000  0.0000000     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    2.4876735  -1.104516     0.0000000  0.0000000     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    4.7175217  -2.115911     0.0000000  0.0000000     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   -4.6764519  -3.638915     0.0000000  0.0000000     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    4.6846502   8.980901     0.0000000  0.0000000     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   -3.1574121  23.769468     0.0000000  0.0000000     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    2.3400095  -8.205967     0.0000000  0.0000000     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  -12.7428915 -13.417983     0.0000000  0.0000000     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   -0.7955426  -1.206159     0.0000000  0.0000000     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   5.2094586   1.623828     0.0000000  0.0000000     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   0.0000000   0.000000     2.2822883 -5.5313129     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   0.0000000   0.000000     5.1506990  1.6055121     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13   0.0000000   0.000000     1.2362452 -0.5488874     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14   0.0000000   0.000000     5.7208992 -2.5659471     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15   0.0000000   0.000000    -5.0680524 -3.9436331     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16   0.0000000   0.000000    -3.7998762 -7.2847086     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17   0.0000000   0.000000    -2.7230856 20.4997932     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18   0.0000000   0.000000    -0.3118919  1.0937453     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19   0.0000000   0.000000    -0.9638764 -1.0149405     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20   0.0000000   0.000000    -1.5233491 -2.3096211     0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21   0.0000000   0.000000     0.0000000  0.0000000    -2.6141373  6.3355761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22   0.0000000   0.000000     0.0000000  0.0000000    -1.3144383  0.5836048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23   0.0000000   0.000000     0.0000000  0.0000000     4.1088851 -1.8429239</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24   0.0000000   0.000000     0.0000000  0.0000000    -0.8673261 -0.6748975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25   0.0000000   0.000000     0.0000000  0.0000000    -0.6061550 -1.1620542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26   0.0000000   0.000000     0.0000000  0.0000000    -0.1800481  1.3554291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27   0.0000000   0.000000     0.0000000  0.0000000     2.6193659 -9.1856169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28   0.0000000   0.000000     0.0000000  0.0000000    -3.6405636 -3.8334329</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29   0.0000000   0.000000     0.0000000  0.0000000     6.3488353  9.6257670</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30   0.0000000   0.000000     0.0000000  0.0000000    -3.8544180 -1.2014514</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Monte Carlo approach, simple trend test example</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim.html">categorical</a></span><span class="op">(</span><span class="fu"><a href="lvm.html">lvm</a></span><span class="op">(</span><span class="op">)</span>,<span class="op">~</span><span class="va">x</span>,K<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="regression-set.html">regression</a></span><span class="op">(</span><span class="va">m</span>,additive<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">m</span>,<span class="fl">100</span>,seed<span class="op">=</span><span class="fl">1</span>,<span class="st">'y~x'</span><span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">x</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">null</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">##  just need to make sure we simulate under H0: slope=0</span></span></span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">l</span>,<span class="va">f</span>,R<span class="op">=</span><span class="fl">1e2</span>,null.sim<span class="op">=</span><span class="va">null</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 replications</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          seq_along(x)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean         0.014709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SD           0.065440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.5%        -0.097458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97.5%        0.146613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimate     0.080949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P-value      0.180000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">estimate</span><span class="op">(</span><span class="va">l</span>,<span class="va">f</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std.Err     2.5%  97.5% P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> seq_along(x)  0.08095 0.06135 -0.03929 0.2012   0.187</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Klaus K. Holst.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

